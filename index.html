<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mydeal - Ù†Ø¸Ø§Ù… ØªØ¬Ø§Ø±Ø© Ø§Ù„ÙˆØ±Ù‚ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Ø¥Ø¶Ø§ÙØ© Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        /* Ø§Ù„Ø£Ù†Ù…Ø§Ø· ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ */
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            direction: rtl;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background-color: white;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo i {
            color: var(--secondary);
            font-size: 28px;
        }

        .logo h1 {
            font-size: 24px;
            color: var(--primary);
        }

        .logo span {
            color: var(--secondary);
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 25px;
        }

        nav a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: var(--transition);
            padding: 5px 0;
            position: relative;
        }

        nav a:hover {
            color: var(--secondary);
        }

        .btn {
            display: inline-block;
            background-color: var(--secondary);
            color: white;
            padding: 12px 30px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
            border: none;
            cursor: pointer;
            font-size: 16px;
        }

        .btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        .btn-danger {
            background-color: var(--accent);
        }

        .btn-warning {
            background-color: var(--warning);
        }

        .btn-success {
            background-color: var(--success);
        }

        .btn-whatsapp {
            background-color: #25D366;
        }

        .btn-whatsapp:hover {
            background-color: #128C7E;
        }

        .section-title {
            text-align: center;
            margin: 60px 0 40px;
            color: var(--primary);
        }

        .product-selector {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 40px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: var(--transition);
        }

        .form-control:focus {
            border-color: var(--secondary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        .price-display {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid var(--secondary);
        }

        .price-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--accent);
        }

        .dimensions-info {
            display: flex;
            gap: 15px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .dimension {
            background-color: white;
            padding: 10px 15px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .dimension span {
            font-weight: 600;
            color: var(--primary);
        }

        .calculation-steps {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border-right: 4px solid var(--success);
        }

        .calculation-steps h4 {
            margin-bottom: 10px;
            color: var(--primary);
        }

        .step {
            margin: 5px 0;
            padding: 5px;
            background: white;
            border-radius: 4px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: var(--success);
            color: white;
            padding: 15px 20px;
            border-radius: 5px;
            box-shadow: var(--shadow);
            z-index: 1001;
            display: none;
            max-width: 300px;
        }

        .notification.error {
            background-color: var(--accent);
        }

        .admin-panel {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 60px;
        }

        .product-card {
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            background: white;
            transition: var(--transition);
        }

        .product-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .login-modal, .edit-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .login-content, .edit-content {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: var(--shadow);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--secondary);
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--secondary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .payment-section {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 40px;
        }

        .payment-steps {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
        }

        .payment-step {
            flex: 1;
            min-width: 250px;
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            transition: var(--transition);
        }

        .payment-step:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }

        .step-icon {
            font-size: 2rem;
            color: var(--secondary);
            margin-bottom: 15px;
        }

        .payment-step h4 {
            margin-bottom: 10px;
            color: var(--primary);
        }

        .vodafone-number {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent);
            margin: 10px 0;
        }

        .dimensions-input {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .dimensions-input input {
            flex: 1;
        }

        .dimensions-list {
            margin-top: 10px;
            max-height: 150px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
        }

        .dimension-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px;
            border-bottom: 1px solid #eee;
        }

        .dimension-item:last-child {
            border-bottom: none;
        }

        /* Ø£Ù†Ù…Ø§Ø· Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø© */
        .cart-items {
            margin-top: 20px;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 15px;
            background: white;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quantity-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--secondary);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quantity-value {
            font-weight: bold;
            min-width: 30px;
            text-align: center;
        }

        .cart-total {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid var(--secondary);
            text-align: center;
        }

        .cart-empty {
            text-align: center;
            padding: 20px;
            color: #777;
        }

        .orders-list {
            max-height: 500px;
            overflow-y: auto;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            nav ul {
                gap: 15px;
            }
            
            .dimensions-input {
                flex-direction: column;
            }
            
            .cart-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .cart-item-actions {
                width: 100%;
                justify-content: space-between;
            }
        }
    </style>
</head>
<body>
    <!-- Notifications -->
    <div class="notification" id="notification">
        <i class="fas fa-bell"></i> <span id="notification-text"></span>
    </div>

    <!-- Loading -->
    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
        <p>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
    </div>

    <!-- Login Modal -->
    <div class="login-modal" id="loginModal">
        <div class="login-content">
            <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>
            <div class="form-group">
                <label for="adminEmail">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                <input type="email" id="adminEmail" class="form-control" placeholder="your admin email">
            </div>
            <div class="form-group">
                <label for="adminPassword">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                <input type="password" id="adminPassword" class="form-control" placeholder="your admin password">
            </div>
            <button class="btn" onclick="adminLogin()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
            <button class="btn btn-danger" onclick="closeModal('loginModal')" style="margin-top: 10px;">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>

    <!-- Edit Product Modal -->
    <div class="edit-modal" id="editModal">
        <div class="edit-content">
            <h2>ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬</h2>
            <div class="form-group">
                <label for="editProductName">Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</label>
                <input type="text" id="editProductName" class="form-control">
            </div>
            <div class="form-group">
                <label for="editProductType">Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬</label>
                <select id="editProductType" class="form-control">
                    <option value="thermal">ÙˆØ±Ù‚ Ø­Ø±Ø§Ø±ÙŠ</option>
                    <option value="wax">Ø±ÙŠØ¨ÙˆÙ† Ø´Ù…Ø¹ÙŠ</option>
                    <option value="resin">Ø±ÙŠØ¨ÙˆÙ† Ø±ÙŠØ²ÙŠÙ†</option>
                    <option value="wax-resin">Ø±ÙŠØ¨ÙˆÙ† Ø´Ù…Ø¹ÙŠ Ø±ÙŠØ²ÙŠÙ†</option>
                    <option value="white">ÙˆØ±Ù‚ Ø£Ø¨ÙŠØ¶ Ù†ØµÙ Ù„Ø§Ù…Ø¹</option>
                    <option value="plastic">Ø¨Ù„Ø§Ø³ØªÙŠÙƒ</option>
                </select>
            </div>
            <div class="form-group">
                <label for="editProductPrice">Ø³Ø¹Ø± Ø§Ù„Ù…ØªØ± (Ø¬Ù†ÙŠÙ‡)</label>
                <input type="number" id="editProductPrice" class="form-control" step="0.01">
            </div>
            
            <div class="form-group">
                <label>Ø§Ù„Ø£Ø·ÙˆØ§Ù„ Ø§Ù„Ù…ØªØ§Ø­Ø© (Ø³Ù…)</label>
                <div class="dimensions-input">
                    <input type="number" id="newLength" class="form-control" placeholder="Ø£Ø¯Ø®Ù„ Ø·ÙˆÙ„ Ø¬Ø¯ÙŠØ¯">
                    <button class="btn btn-success" onclick="addLength()">Ø¥Ø¶Ø§ÙØ©</button>
                </div>
                <div class="dimensions-list" id="lengthsList"></div>
            </div>

            <div class="form-group">
                <label>Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…ØªØ§Ø­Ø© (Ø³Ù…)</label>
                <div class="dimensions-input">
                    <input type="number" id="newWidth" class="form-control" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ø±Ø¶ Ø¬Ø¯ÙŠØ¯">
                    <button class="btn btn-success" onclick="addWidth()">Ø¥Ø¶Ø§ÙØ©</button>
                </div>
                <div class="dimensions-list" id="widthsList"></div>
            </div>

            <div class="form-group">
                <label for="editProductActive">Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù†ØªØ¬</label>
                <select id="editProductActive" class="form-control">
                    <option value="true">Ù†Ø´Ø·</option>
                    <option value="false">ØºÙŠØ± Ù†Ø´Ø·</option>
                </select>
            </div>

            <button class="btn btn-success" onclick="updateProduct()">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
            <button class="btn btn-danger" onclick="closeModal('editModal')" style="margin-top: 10px;">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>

    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-scroll"></i>
                    <h1>Mydeal <span>Ù„ØªØ¬Ø§Ø±Ø© Ø§Ù„ÙˆØ±Ù‚</span></h1>
                </div>
                <nav>
                    <ul>
                        <li><a href="#home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
                        <li><a href="#products">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</a></li>
                        <li><a href="#payment">Ø§Ù„Ø¯ÙØ¹</a></li>
                        <li><a href="#" id="adminLink">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</a></li>
                        <li><a href="#" id="logoutLink" style="display: none;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <section id="home">
        <div class="container">
            <div class="section-title">
                <h2>Ù…ØªØ¬Ø± ÙˆØ±Ù‚ ÙˆØ§Ø³ØªÙŠÙƒØ±Ø§Øª MyDeal</h2>
                <p>ØªØ³ÙˆÙ‚ ÙˆØ§Ø´ØªØ±ÙŠ Ø§Ù„Ø§Ù† Ø¨Ø§Ø³Ø¹Ø§Ø± ØªÙ†Ø§ÙØ³ÙŠØ©</p>
            </div>

            <div class="product-selector">
                <div class="form-group">
                    <label for="productType">Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬</label>
                    <select id="productType" class="form-control">
                        <option value="">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="length">Ø§Ù„Ø·ÙˆÙ„ (Ø³Ù…)</label>
                    <select id="length" class="form-control" disabled>
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØªØ¬ Ø£ÙˆÙ„Ø§Ù‹</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="width">Ø§Ù„Ø¹Ø±Ø¶ (Ø³Ù…)</label>
                    <select id="width" class="form-control" disabled>
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØªØ¬ Ø£ÙˆÙ„Ø§Ù‹</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="quantity">Ø§Ù„ÙƒÙ…ÙŠØ© (Ø§Ø³ØªÙŠÙƒØ±)</label>
                    <select id="quantity" class="form-control">
                        <option value="1000">1000 Ø§Ø³ØªÙŠÙƒØ± (Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¹Ø§Ø¯ÙŠ)</option>
                        <option value="500">500 Ø§Ø³ØªÙŠÙƒØ± (Ù†ØµÙ Ø§Ù„Ø³Ø¹Ø±)</option>
                        <option value="2000">2000 Ø§Ø³ØªÙŠÙƒØ± (Ø¶Ø¹Ù Ø§Ù„Ø³Ø¹Ø±)</option>
                    </select>
                </div>

                <button class="btn" onclick="addToCart()">Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©</button>

                <!-- Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚ -->
                <div class="cart-items" id="cartItems" style="display: none;">
                    <h3>Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚</h3>
                    <div id="cartItemsList"></div>
                    <div class="cart-total">
                        <h4>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: <span id="cartTotalPrice">0</span> Ø¬Ù†ÙŠÙ‡</h4>
                        <button class="btn btn-success" onclick="calculateTotalPrice()">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</button>
                        <button class="btn btn-danger" onclick="clearCart()" style="margin-top: 10px;">ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©</button>
                    </div>
                </div>

                <div class="price-display">
                    <h3>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</h3>
                    <div class="price-value" id="priceValue">0 Ø¬Ù†ÙŠÙ‡</div>
                    <div class="dimensions-info">
                        <div class="dimension">Ø§Ù„Ø·ÙˆÙ„: <span id="selectedLength">-</span></div>
                        <div class="dimension">Ø§Ù„Ø¹Ø±Ø¶: <span id="selectedWidth">-</span></div>
                        <div class="dimension">Ø§Ù„ÙƒÙ…ÙŠØ©: <span id="selectedQuantity">-</span></div>
                        <div class="dimension">Ø³Ø¹Ø± Ø§Ù„Ù…ØªØ±: <span id="pricePerMeter">-</span></div>
                    </div>
                    
                    <div class="calculation-steps" id="calculationSteps" style="display: none;">
                        <h4>Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø­Ø³Ø§Ø¨:</h4>
                        <div id="stepsContent"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Payment Section -->
    <section id="payment">
        <div class="container">
            <div class="section-title">
                <h2>Ø§Ù„Ø¯ÙØ¹ Ø¹Ø¨Ø± ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´</h2>
                <p>Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ£Ù…Ø§Ù†</p>
            </div>

            <div class="payment-section">
                <div class="payment-steps">
                    <div class="payment-step">
                        <div class="step-icon">
                            <i class="fas fa-calculator"></i>
                        </div>
                        <h4>Ø§Ù„Ø®Ø·ÙˆØ© 1</h4>
                        <p>Ø§Ø­Ø³Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø£Ø¹Ù„Ø§Ù‡</p>
                    </div>
                    <div class="payment-step">
                        <div class="step-icon">
                            <i class="fas fa-mobile-alt"></i>
                        </div>
                        <h4>Ø§Ù„Ø®Ø·ÙˆØ© 2</h4>
                        <p>Ù‚Ù… Ø¨Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ø±Ù‚Ù… ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´ Ø§Ù„ØªØ§Ù„ÙŠ:</p>
                        <div class="vodafone-number">01008559292</div>
                    </div>
                    <div class="payment-step">
                        <div class="step-icon">
                            <i class="fab fa-whatsapp"></i>
                        </div>
                        <h4>Ø§Ù„Ø®Ø·ÙˆØ© 3</h4>
                        <p>Ø£Ø±Ø³Ù„ Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯ÙØ¹ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</p>
                        <button class="btn btn-whatsapp" id="whatsappBtn" onclick="sendWhatsAppMessage()" disabled>
                            <i class="fab fa-whatsapp"></i> Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨
                        </button>
                    </div>
                    <div class="payment-step">
                        <div class="step-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h4>Ø§Ù„Ø®Ø·ÙˆØ© 4</h4>
                        <p>Ø³Ù†Ù‚ÙˆÙ… Ø¨ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨Ùƒ ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡ Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Admin Section -->
    <section id="adminSection" style="display: none;">
        <div class="container">
            <div class="section-title">
                <h2>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© - Firebase</h2>
                <p>Ø¥Ø¯Ø§Ø±Ø© ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø± ÙˆØ§Ù„Ø·Ù„Ø¨Ø§Øª</p>
            </div>

            <div class="admin-panel">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalProducts">0</div>
                        <div>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalOrders">0</div>
                        <div>Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalRevenue">0</div>
                        <div>Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª (Ø¬Ù†ÙŠÙ‡)</div>
                    </div>
                </div>

                <div class="form-group">
                    <h3>Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</h3>
                    <input type="text" id="newProductName" class="form-control" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬" style="margin-bottom: 10px;">
                    <select id="newProductType" class="form-control" style="margin-bottom: 10px;">
                        <option value="thermal">ÙˆØ±Ù‚ Ø­Ø±Ø§Ø±ÙŠ</option>
                        <option value="wax">Ø±ÙŠØ¨ÙˆÙ† Ø´Ù…Ø¹ÙŠ</option>
                        <option value="resin">Ø±ÙŠØ¨ÙˆÙ† Ø±ÙŠØ²ÙŠÙ†</option>
                        <option value="wax-resin">Ø±ÙŠØ¨ÙˆÙ† Ø´Ù…Ø¹ÙŠ Ø±ÙŠØ²ÙŠÙ†</option>
                        <option value="white">ÙˆØ±Ù‚ Ø£Ø¨ÙŠØ¶ Ù†ØµÙ Ù„Ø§Ù…Ø¹</option>
                        <option value="plastic">Ø¨Ù„Ø§Ø³ØªÙŠÙƒ</option>
                    </select>
                    <input type="number" id="newProductPrice" class="form-control" placeholder="Ø³Ø¹Ø± Ø§Ù„Ù…ØªØ±" step="0.01" style="margin-bottom: 10px;">
                    
                    <div class="form-group">
                        <label>Ø§Ù„Ø£Ø·ÙˆØ§Ù„ Ø§Ù„Ù…ØªØ§Ø­Ø© (Ø³Ù…)</label>
                        <div class="dimensions-input">
                            <input type="number" id="newProductLength" class="form-control" placeholder="Ø£Ø¯Ø®Ù„ Ø·ÙˆÙ„ Ø¬Ø¯ÙŠØ¯">
                            <button class="btn btn-success" onclick="addNewProductLength()">Ø¥Ø¶Ø§ÙØ©</button>
                        </div>
                        <div class="dimensions-list" id="newProductLengthsList"></div>
                    </div>

                    <div class="form-group">
                        <label>Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…ØªØ§Ø­Ø© (Ø³Ù…)</label>
                        <div class="dimensions-input">
                            <input type="number" id="newProductWidth" class="form-control" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ø±Ø¶ Ø¬Ø¯ÙŠØ¯">
                            <button class="btn btn-success" onclick="addNewProductWidth()">Ø¥Ø¶Ø§ÙØ©</button>
                        </div>
                        <div class="dimensions-list" id="newProductWidthsList"></div>
                    </div>

                    <button class="btn btn-success" onclick="addProduct()">Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬</button>
                </div>

                <div id="productsList" style="margin-top: 30px;">
                    <h3>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h3>
                    <div id="productsContainer"></div>
                </div>

                <div id="ordersList" style="margin-top: 30px;">
                    <h3>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3>
                    <div class="orders-list" id="ordersContainer"></div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // ğŸ”¥ Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBznBqyjqA87Jp7hQakRgg4okOk6eXxw1E",
            authDomain: "mydeal-6b90d.firebaseapp.com",
            databaseURL: "https://mydeal-6b90d-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "mydeal-6b90d",
            storageBucket: "mydeal-6b90d.firebasestorage.app",
            messagingSenderId: "1026430553997",
            appId: "1:1026430553997:web:3f66722a15a0f87cf9b7c4",
            measurementId: "G-QL9K1RRTL2"
        };

        // Initialize Firebase
        try {
            firebase.initializeApp(firebaseConfig);
            console.log('âœ… Firebase initialized successfully');
        } catch (error) {
            console.error('âŒ Firebase initialization error:', error);
        }
        
        const db = firebase.firestore();

        // Global Variables
        let products = [];
        let orders = [];
        let isAdminLoggedIn = false;
        let currentUser = null;
        let currentOrder = null;
        let isFirebaseConnected = false;
        let currentEditingProduct = null;
        let newProductLengths = [];
        let newProductWidths = [];
        let editingProductLengths = [];
        let editingProductWidths = [];
        
        // Ù…ØªØºÙŠØ±Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø³Ù„Ø©
        let cart = [];
        let totalPrice = 0;
        let currentOrderItems = []; // Ù„ØªØ®Ø²ÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ

        // DOM Elements
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notification-text');
        const loadingElement = document.getElementById('loading');
        const loginModal = document.getElementById('loginModal');
        const adminSection = document.getElementById('adminSection');
        const adminLink = document.getElementById('adminLink');
        const logoutLink = document.getElementById('logoutLink');
        const whatsappBtn = document.getElementById('whatsappBtn');

        // Local Storage Fallback
        const STORAGE_KEYS = {
            PRODUCTS: 'mydeal_products',
            ORDERS: 'mydeal_orders',
            ADMIN_LOGGED_IN: 'mydeal_admin_logged_in',
            CART: 'mydeal_cart',
            CURRENT_ORDER: 'mydeal_current_order'
        };

        // ğŸ”¥ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ
        function setupRealtimeUpdates() {
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ
            db.collection('products').onSnapshot((snapshot) => {
                products = snapshot.docs.map(doc => ({
                    _id: doc.id,
                    ...doc.data()
                }));
                populateProductSelect();
                if (isAdminLoggedIn) {
                    loadAdminProducts();
                }
                showNotification('ğŸ”„ ØªÙ… ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª', false);
            });

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ
            db.collection('orders').onSnapshot((snapshot) => {
                orders = snapshot.docs.map(doc => ({
                    _id: doc.id,
                    ...doc.data()
                }));
                if (isAdminLoggedIn) {
                    loadAdminOrders();
                    updateStats();
                }
            });
        }

        // ğŸ”¥ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Firebase
        function checkFirebaseConnection() {
            return new Promise((resolve) => {
                db.collection('test').limit(1).get()
                    .then(() => {
                        console.log('âœ… Firebase connection successful');
                        isFirebaseConnected = true;
                        resolve(true);
                    })
                    .catch((error) => {
                        console.error('âŒ Firebase connection failed:', error);
                        isFirebaseConnected = false;
                        resolve(false);
                    });
            });
        }

        // ğŸ”¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
        function addNewProductLength() {
            const lengthInput = document.getElementById('newProductLength');
            const length = parseFloat(lengthInput.value);
            
            if (length && !newProductLengths.includes(length)) {
                newProductLengths.push(length);
                updateNewProductLengthsList();
                lengthInput.value = '';
            }
        }

        function addNewProductWidth() {
            const widthInput = document.getElementById('newProductWidth');
            const width = parseFloat(widthInput.value);
            
            if (width && !newProductWidths.includes(width)) {
                newProductWidths.push(width);
                updateNewProductWidthsList();
                widthInput.value = '';
            }
        }

        function updateNewProductLengthsList() {
            const list = document.getElementById('newProductLengthsList');
            list.innerHTML = newProductLengths.map(length => `
                <div class="dimension-item">
                    <span>${length} Ø³Ù…</span>
                    <button class="btn btn-danger btn-sm" onclick="removeNewProductLength(${length})">Ø­Ø°Ù</button>
                </div>
            `).join('');
        }

        function updateNewProductWidthsList() {
            const list = document.getElementById('newProductWidthsList');
            list.innerHTML = newProductWidths.map(width => `
                <div class="dimension-item">
                    <span>${width} Ø³Ù…</span>
                    <button class="btn btn-danger btn-sm" onclick="removeNewProductWidth(${width})">Ø­Ø°Ù</button>
                </div>
            `).join('');
        }

        function removeNewProductLength(length) {
            newProductLengths = newProductLengths.filter(l => l !== length);
            updateNewProductLengthsList();
        }

        function removeNewProductWidth(width) {
            newProductWidths = newProductWidths.filter(w => w !== width);
            updateNewProductWidthsList();
        }

        // ğŸ”¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ù„Ù„Ù…Ù†ØªØ¬ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
        function addLength() {
            const lengthInput = document.getElementById('newLength');
            const length = parseFloat(lengthInput.value);
            
            if (length && !editingProductLengths.includes(length)) {
                editingProductLengths.push(length);
                updateEditingLengthsList();
                lengthInput.value = '';
            }
        }

        function addWidth() {
            const widthInput = document.getElementById('newWidth');
            const width = parseFloat(widthInput.value);
            
            if (width && !editingProductWidths.includes(width)) {
                editingProductWidths.push(width);
                updateEditingWidthsList();
                widthInput.value = '';
            }
        }

        function updateEditingLengthsList() {
            const list = document.getElementById('lengthsList');
            list.innerHTML = editingProductLengths.map(length => `
                <div class="dimension-item">
                    <span>${length} Ø³Ù…</span>
                    <button class="btn btn-danger btn-sm" onclick="removeEditingLength(${length})">Ø­Ø°Ù</button>
                </div>
            `).join('');
        }

        function updateEditingWidthsList() {
            const list = document.getElementById('widthsList');
            list.innerHTML = editingProductWidths.map(width => `
                <div class="dimension-item">
                    <span>${width} Ø³Ù…</span>
                    <button class="btn btn-danger btn-sm" onclick="removeEditingWidth(${width})">Ø­Ø°Ù</button>
                </div>
            `).join('');
        }

        function removeEditingLength(length) {
            editingProductLengths = editingProductLengths.filter(l => l !== length);
            updateEditingLengthsList();
        }

        function removeEditingWidth(width) {
            editingProductWidths = editingProductWidths.filter(w => w !== width);
            updateEditingWidthsList();
        }

        // ğŸ”¥ Firebase Functions
        async function loadProducts() {
            try {
                showLoading();
                const connected = await checkFirebaseConnection();
                
                if (connected) {
                    const snapshot = await db.collection('products').get();
                    products = snapshot.docs.map(doc => ({
                        _id: doc.id,
                        ...doc.data()
                    }));
                    
                    if (products.length === 0) {
                        await addDefaultProducts();
                    }
                    
                    populateProductSelect();
                    if (isAdminLoggedIn) {
                        loadAdminProducts();
                    }
                    
                    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ©
                    setupRealtimeUpdates();
                } else {
                    throw new Error('No Firebase connection');
                }
            } catch (error) {
                console.error('Error loading products:', error);
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø§Ù„Ø°ÙŠ ÙŠØ³Ø¨Ø¨ NaN
                products = [];
                populateProductSelect();
            } finally {
                hideLoading();
            }
        }

        async function addDefaultProducts() {
            const defaultProducts = [
                { 
                    name: 'ÙˆØ±Ù‚ Ø­Ø±Ø§Ø±ÙŠ Ø¹Ø§Ø¯ÙŠ', 
                    type: 'thermal', 
                    price: 32, 
                    active: true, 
                    lengths: [50, 100, 150, 200],
                    widths: [50, 100, 150],
                    createdAt: new Date().toISOString() 
                },
                { 
                    name: 'Ø±ÙŠØ¨ÙˆÙ† Ø´Ù…Ø¹ÙŠ', 
                    type: 'wax', 
                    price: 11, 
                    active: true, 
                    lengths: [100, 200, 300],
                    widths: [50, 75, 100],
                    createdAt: new Date().toISOString() 
                }
            ];

            try {
                for (const product of defaultProducts) {
                    await db.collection('products').add(product);
                }
                console.log('âœ… Default products added successfully');
            } catch (error) {
                console.error('Error adding default products:', error);
            }
        }

        async function addProduct() {
            const name = document.getElementById('newProductName').value;
            const type = document.getElementById('newProductType').value;
            const price = parseFloat(document.getElementById('newProductPrice').value);

            if (!name || !price || newProductLengths.length === 0 || newProductWidths.length === 0) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙˆØ¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯', true);
                return;
            }

            const productData = {
                name: name,
                type: type,
                price: price,
                lengths: newProductLengths,
                widths: newProductWidths,
                active: true,
                createdAt: new Date().toISOString()
            };

            try {
                showLoading();
                await db.collection('products').add(productData);
                showNotification('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­');
                
                // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø­Ù‚ÙˆÙ„
                document.getElementById('newProductName').value = '';
                document.getElementById('newProductPrice').value = '';
                newProductLengths = [];
                newProductWidths = [];
                updateNewProductLengthsList();
                updateNewProductWidthsList();
                
            } catch (error) {
                console.error('Error adding product:', error);
                showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬', true);
            } finally {
                hideLoading();
            }
        }

        function editProduct(productId) {
            const product = products.find(p => p._id === productId);
            if (!product) return;

            currentEditingProduct = product;
            editingProductLengths = [...(product.lengths || [])];
            editingProductWidths = [...(product.widths || [])];

            document.getElementById('editProductName').value = product.name;
            document.getElementById('editProductType').value = product.type;
            document.getElementById('editProductPrice').value = product.price;
            document.getElementById('editProductActive').value = product.active.toString();

            updateEditingLengthsList();
            updateEditingWidthsList();

            openModal('editModal');
        }

        async function updateProduct() {
            if (!currentEditingProduct) return;

            const name = document.getElementById('editProductName').value;
            const type = document.getElementById('editProductType').value;
            const price = parseFloat(document.getElementById('editProductPrice').value);
            const active = document.getElementById('editProductActive').value === 'true';

            if (!name || !price || editingProductLengths.length === 0 || editingProductWidths.length === 0) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', true);
                return;
            }

            const updates = {
                name: name,
                type: type,
                price: price,
                lengths: editingProductLengths,
                widths: editingProductWidths,
                active: active,
                updatedAt: new Date().toISOString()
            };

            try {
                showLoading();
                await db.collection('products').doc(currentEditingProduct._id).update(updates);
                showNotification('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­');
                closeModal('editModal');
            } catch (error) {
                console.error('Error updating product:', error);
                showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬', true);
            } finally {
                hideLoading();
            }
        }

        async function deleteProduct(productId) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŸ')) return;

            try {
                showLoading();
                await db.collection('products').doc(productId).delete();
                showNotification('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­');
            } catch (error) {
                console.error('Error deleting product:', error);
                showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬', true);
            } finally {
                hideLoading();
            }
        }

        async function loadOrders() {
            try {
                const snapshot = await db.collection('orders').orderBy('createdAt', 'desc').get();
                orders = snapshot.docs.map(doc => ({
                    _id: doc.id,
                    ...doc.data()
                }));
                
                if (isAdminLoggedIn) {
                    loadAdminOrders();
                    updateStats();
                }
            } catch (error) {
                console.error('Error loading orders:', error);
                orders = getLocalOrders();
            }
        }

        async function createOrder(orderData) {
            try {
                await db.collection('orders').add(orderData);
                showNotification('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
                currentOrder = orderData;
                whatsappBtn.disabled = false;
                
                // Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
                localStorage.setItem(STORAGE_KEYS.CURRENT_ORDER, JSON.stringify(orderData));
            } catch (error) {
                console.error('Error creating order:', error);
                showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨', true);
            }
        }

        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¯Ø§Ù„Ø© getDefaultProducts() Ø§Ù„ØªÙŠ ØªØ³Ø¨Ø¨ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©
        function getLocalOrders() {
            return JSON.parse(localStorage.getItem(STORAGE_KEYS.ORDERS) || '[]');
        }

        // ğŸ”¥ ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function populateProductSelect() {
            const select = document.getElementById('productType');
            select.innerHTML = '<option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬</option>';
            
            if (products.length === 0) {
                select.innerHTML = '<option value="">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù…ØªØ§Ø­Ø©</option>';
                return;
            }
            
            products.filter(p => p.active).forEach(product => {
                const option = document.createElement('option');
                option.value = product.type;
                option.textContent = `${product.name} - ${product.price} Ø¬Ù†ÙŠÙ‡/Ù…ØªØ±`;
                select.appendChild(option);
            });
        }

        function updateDimensionsSelects() {
            const productType = document.getElementById('productType').value;
            const lengthSelect = document.getElementById('length');
            const widthSelect = document.getElementById('width');
            
            lengthSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø·ÙˆÙ„</option>';
            widthSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¹Ø±Ø¶</option>';
            
            if (!productType) {
                lengthSelect.disabled = true;
                widthSelect.disabled = true;
                return;
            }

            const product = products.find(p => p.type === productType);
            if (!product) return;

            lengthSelect.disabled = false;
            widthSelect.disabled = false;

            // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø£Ø·ÙˆØ§Ù„
            (product.lengths || []).forEach(length => {
                const option = document.createElement('option');
                option.value = length;
                option.textContent = `${length} Ø³Ù…`;
                lengthSelect.appendChild(option);
            });

            // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¹Ø±ÙˆØ¶
            (product.widths || []).forEach(width => {
                const option = document.createElement('option');
                option.value = width;
                option.textContent = `${width} Ø³Ù…`;
                widthSelect.appendChild(option);
            });
        }

        // ğŸ”¥ Admin Functions
        function loadAdminProducts() {
            const container = document.getElementById('productsContainer');
            container.innerHTML = '';

            if (products.length === 0) {
                container.innerHTML = '<div class="cart-empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</div>';
                return;
            }

            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.innerHTML = `
                    <h4>${product.name}</h4>
                    <p>Ø§Ù„Ù†ÙˆØ¹: ${getProductTypeName(product.type)}</p>
                    <p>Ø§Ù„Ø³Ø¹Ø±: ${product.price} Ø¬Ù†ÙŠÙ‡ Ù„Ù„Ù…ØªØ±</p>
                    <p>Ø§Ù„Ø£Ø·ÙˆØ§Ù„: ${(product.lengths || []).join('ØŒ ')} Ø³Ù…</p>
                    <p>Ø§Ù„Ø¹Ø±ÙˆØ¶: ${(product.widths || []).join('ØŒ ')} Ø³Ù…</p>
                    <p>Ø§Ù„Ø­Ø§Ù„Ø©: ${product.active ? 'Ù†Ø´Ø·' : 'ØºÙŠØ± Ù†Ø´Ø·'}</p>
                    <div style="margin-top: 10px;">
                        <button class="btn btn-warning" onclick="editProduct('${product._id}')">ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="btn btn-danger" onclick="deleteProductConfirm('${product._id}')">Ø­Ø°Ù</button>
                    </div>
                `;
                container.appendChild(productCard);
            });
        }

        function loadAdminOrders() {
            const container = document.getElementById('ordersContainer');
            container.innerHTML = '';

            // Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
            if (orders.length === 0) {
                container.innerHTML = '<div class="cart-empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</div>';
                return;
            }

            orders.forEach(order => {
                const orderCard = document.createElement('div');
                orderCard.className = 'product-card';
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨ (Ù…Ù†ØªØ¬ ÙˆØ§Ø­Ø¯ Ø£Ùˆ Ù…ØªØ¹Ø¯Ø¯)
                if (order.items) {
                    // Ø·Ù„Ø¨ Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                    orderCard.innerHTML = `
                        <h4>Ø·Ù„Ø¨ #${order.orderNumber}</h4>
                        <p>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: ${order.items.length}</p>
                        <div style="margin: 10px 0; padding: 10px; background: #f8f9fa; border-radius: 5px;">
                            ${order.items.map(item => `
                                <div style="margin-bottom: 5px;">
                                    ${item.productName} - ${item.length}Ã—${item.width} Ø³Ù… - ${item.quantity} Ø§Ø³ØªÙŠÙƒØ± - ${item.itemPrice} Ø¬Ù†ÙŠÙ‡
                                </div>
                            `).join('')}
                        </div>
                        <p><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: ${order.totalPrice} Ø¬Ù†ÙŠÙ‡</strong></p>
                        <p>Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date(order.createdAt).toLocaleDateString('ar-EG')}</p>
                        <p>Ø§Ù„ÙˆÙ‚Øª: ${new Date(order.createdAt).toLocaleTimeString('ar-EG')}</p>
                    `;
                } else {
                    // Ø·Ù„Ø¨ Ù…Ù†ØªØ¬ ÙˆØ§Ø­Ø¯
                    orderCard.innerHTML = `
                        <h4>Ø·Ù„Ø¨ #${order.orderNumber}</h4>
                        <p>Ø§Ù„Ù…Ù†ØªØ¬: ${order.productName}</p>
                        <p>Ø§Ù„Ù…Ù‚Ø§Ø³: ${order.length} Ã— ${order.width} Ø³Ù…</p>
                        <p>Ø§Ù„ÙƒÙ…ÙŠØ©: ${order.quantity} Ø§Ø³ØªÙŠÙƒØ±</p>
                        <p>Ø§Ù„Ø³Ø¹Ø±: ${order.totalPrice} Ø¬Ù†ÙŠÙ‡</p>
                        <p>Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date(order.createdAt).toLocaleDateString('ar-EG')}</p>
                        <p>Ø§Ù„ÙˆÙ‚Øª: ${new Date(order.createdAt).toLocaleTimeString('ar-EG')}</p>
                    `;
                }
                
                container.appendChild(orderCard);
            });
        }

        function updateStats() {
            document.getElementById('totalProducts').textContent = products.length;
            document.getElementById('totalOrders').textContent = orders.length;
            const totalRevenue = orders.reduce((sum, order) => sum + order.totalPrice, 0);
            document.getElementById('totalRevenue').textContent = totalRevenue.toLocaleString();
        }

        // ğŸ”¥ Authentication
        function adminLogin() {
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;

            if (email === 'admin@mydeal.com' && password === 'admin123') {
                isAdminLoggedIn = true;
                currentUser = { email: email, role: 'admin' };
                localStorage.setItem(STORAGE_KEYS.ADMIN_LOGGED_IN, 'true');
                closeModal('loginModal');
                adminSection.style.display = 'block';
                adminLink.style.display = 'none';
                logoutLink.style.display = 'block';
                loadAdminProducts();
                loadAdminOrders();
                updateStats();
                showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­');
            } else {
                showNotification('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©', true);
            }
        }

        function adminLogout() {
            isAdminLoggedIn = false;
            currentUser = null;
            localStorage.setItem(STORAGE_KEYS.ADMIN_LOGGED_IN, 'false');
            adminSection.style.display = 'none';
            adminLink.style.display = 'block';
            logoutLink.style.display = 'none';
            showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬');
        }

        // ğŸ”¥ ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø³Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© - ØªÙ… Ø¥ØµÙ„Ø§Ø­Ù‡Ø§
        function addToCart() {
            const productType = document.getElementById('productType').value;
            const length = document.getElementById('length').value;
            const width = document.getElementById('width').value;
            const quantity = document.getElementById('quantity').value;

            if (!productType || !length || !width) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù†ØªØ¬ ÙˆØ§Ù„Ø£Ø¨Ø¹Ø§Ø¯', true);
                return;
            }

            const product = products.find(p => p.type === productType);
            if (!product) {
                showNotification('Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', true);
                return;
            }

            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø±
            let price = calculateItemPrice(product, length, width, quantity);
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©
            const cartItem = {
                id: Date.now().toString(),
                productName: product.name,
                productType: productType,
                length: parseFloat(length),
                width: parseFloat(width),
                quantity: quantity,
                unitPrice: product.price,
                itemPrice: price,
                createdAt: new Date().toISOString()
            };

            cart.push(cartItem);
            updateCartDisplay();
            showNotification(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${product.name} Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©`);
        }

        function calculateItemPrice(product, length, width, quantity) {
            let price = 0;
            const numLength = parseFloat(length);
            const numWidth = parseFloat(width);
            const pricePerMeter = product.price;

            if (['thermal', 'white', 'plastic'].includes(product.type)) {
                price = (numLength * numWidth * pricePerMeter) / 1000;
            } else if (['wax', 'resin', 'wax-resin'].includes(product.type)) {
                price = (numWidth * numLength * pricePerMeter);
            }

            if (quantity === "500") {
                price = price / 2;
            } else if (quantity === "2000") {
                price = price * 2;
            }

            return Math.round(price);
        }

        function updateCartDisplay() {
            const cartItemsList = document.getElementById('cartItemsList');
            const cartItemsContainer = document.getElementById('cartItems');
            
            if (cart.length === 0) {
                cartItemsList.innerHTML = '<div class="cart-empty">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</div>';
                cartItemsContainer.style.display = 'none';
                return;
            }

            cartItemsContainer.style.display = 'block';
            
            cartItemsList.innerHTML = cart.map(item => `
                <div class="cart-item">
                    <div class="cart-item-info">
                        <h4>${item.productName}</h4>
                        <p>Ø§Ù„Ù…Ù‚Ø§Ø³: ${item.length} Ã— ${item.width} Ø³Ù…</p>
                        <p>Ø§Ù„ÙƒÙ…ÙŠØ©: ${item.quantity} Ø§Ø³ØªÙŠÙƒØ±</p>
                        <p>Ø§Ù„Ø³Ø¹Ø±: ${item.itemPrice} Ø¬Ù†ÙŠÙ‡</p>
                    </div>
                    <div class="cart-item-actions">
                        <button class="btn btn-danger" onclick="removeFromCart('${item.id}')">Ø­Ø°Ù</button>
                    </div>
                </div>
            `).join('');

            updateCartTotal();
        }

        function removeFromCart(itemId) {
            cart = cart.filter(item => item.id !== itemId);
            updateCartDisplay();
            showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Ø§Ù„Ø³Ù„Ø©');
        }

        function updateCartTotal() {
            totalPrice = cart.reduce((sum, item) => sum + item.itemPrice, 0);
            document.getElementById('cartTotalPrice').textContent = totalPrice.toLocaleString();
        }

        // ğŸ”¥ Ø¯Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©: ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©
        function clearCart() {
            cart = [];
            updateCartDisplay();
            showNotification('ØªÙ… ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©');
        }

        function calculateTotalPrice() {
            if (cart.length === 0) {
                showNotification('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©', true);
                return;
            }

            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙƒÙ„ÙŠ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
            totalPrice = cart.reduce((sum, item) => sum + item.itemPrice, 0);
            
            // Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„ÙƒÙ„ÙŠ - Ø§Ù„Ø³Ù„Ø© ØªÙØ¶Ù„ ÙƒÙ…Ø§ Ù‡ÙŠ
            const orderData = {
                items: [...cart], // Ù†Ø³Ø®Ø© Ù…Ù† Ø§Ù„Ø³Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                totalPrice: totalPrice,
                createdAt: new Date().toISOString(),
                orderNumber: 'ORD-' + Date.now()
            };
            
            createOrder(orderData);
            showNotification(`ØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${totalPrice.toLocaleString()} Ø¬Ù†ÙŠÙ‡ ÙˆØªÙ… Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨`);
            
            // Ø¥Ø¸Ù‡Ø§Ø± ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨
            document.getElementById('priceValue').textContent = totalPrice.toLocaleString() + ' Ø¬Ù†ÙŠÙ‡';
            document.getElementById('calculationSteps').style.display = 'block';
            
            const stepsContent = document.getElementById('stepsContent');
            stepsContent.innerHTML = `
                <div class="step">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: ${cart.length}</div>
                ${cart.map(item => `
                    <div class="step">${item.productName}: ${item.itemPrice} Ø¬Ù†ÙŠÙ‡</div>
                `).join('')}
                <div class="step">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: ${totalPrice} Ø¬Ù†ÙŠÙ‡</div>
            `;
            
            // âš ï¸ Ù…Ù‡Ù…: Ù„Ø§ ÙŠØªÙ… ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø­ÙØ¸
            // ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬Ø§Øª Ø£Ø®Ø±Ù‰ Ù„Ù†ÙØ³ Ø§Ù„Ø·Ù„Ø¨
        }

        // ğŸ”¥ WhatsApp Integration
        function sendWhatsAppMessage() {
            if (!currentOrder) {
                showNotification('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø¨ Ø­Ø§Ù„ÙŠØ§Ù‹', true);
                return;
            }

            const phoneNumber = "201008559292";
            let message = `Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ù„Ù‚Ø¯ Ù‚Ù…Øª Ø¨Ø¹Ù…Ù„ÙŠØ© Ø´Ø±Ø§Ø¡ Ù…Ù† Mydeal:\n\n`;

            if (currentOrder.items) {
                // Ø·Ù„Ø¨ Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                message += `Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: ${currentOrder.items.length}\n`;
                currentOrder.items.forEach(item => {
                    message += `- ${item.productName}: ${item.length}Ã—${item.width} Ø³Ù…ØŒ ${item.quantity} Ø§Ø³ØªÙŠÙƒØ±ØŒ ${item.itemPrice} Ø¬Ù†ÙŠÙ‡\n`;
                });
                message += `\nØ§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: ${currentOrder.totalPrice} Ø¬Ù†ÙŠÙ‡\n`;
            } else {
                // Ø·Ù„Ø¨ Ù…Ù†ØªØ¬ ÙˆØ§Ø­Ø¯
                message += `Ø§Ù„Ù…Ù†ØªØ¬: ${currentOrder.productName}\n`;
                message += `Ø§Ù„Ù…Ù‚Ø§Ø³: ${currentOrder.length} Ã— ${currentOrder.width} Ø³Ù…\n`;
                message += `Ø§Ù„ÙƒÙ…ÙŠØ©: ${currentOrder.quantity} Ø§Ø³ØªÙŠÙƒØ±\n`;
                message += `Ø§Ù„Ù…Ø¨Ù„Øº: ${currentOrder.totalPrice} Ø¬Ù†ÙŠÙ‡\n`;
            }

            message += `Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${currentOrder.orderNumber}\n\n`;
            message += `ÙŠØ±Ø¬Ù‰ ØªØ£ÙƒÙŠØ¯ Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø¯ÙØ¹ ÙˆØªÙ†ÙÙŠØ° Ø§Ù„Ø·Ù„Ø¨. Ø´ÙƒØ±Ø§Ù‹!`;

            const encodedMessage = encodeURIComponent(message);
            const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodedMessage}`;
            
            window.open(whatsappUrl, '_blank');
            showNotification('Ø¬Ø§Ø±Ù ÙØªØ­ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯ÙØ¹');
        }

        // Helper Functions
        function showLoading() {
            loadingElement.style.display = 'block';
        }

        function hideLoading() {
            loadingElement.style.display = 'none';
        }

        function showNotification(message, isError = false) {
            notificationText.textContent = message;
            notification.className = 'notification' + (isError ? ' error' : '');
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 4000);
        }

        function getProductTypeName(type) {
            const types = {
                'thermal': 'ÙˆØ±Ù‚ Ø­Ø±Ø§Ø±ÙŠ',
                'wax': 'Ø±ÙŠØ¨ÙˆÙ† Ø´Ù…Ø¹ÙŠ',
                'resin': 'Ø±ÙŠØ¨ÙˆÙ† Ø±ÙŠØ²ÙŠÙ†',
                'wax-resin': 'Ø±ÙŠØ¨ÙˆÙ† Ø´Ù…Ø¹ÙŠ Ø±ÙŠØ²ÙŠÙ†',
                'white': 'ÙˆØ±Ù‚ Ø£Ø¨ÙŠØ¶ Ù†ØµÙ Ù„Ø§Ù…Ø¹',
                'plastic': 'Ø¨Ù„Ø§Ø³ØªÙŠÙƒ'
            };
            return types[type] || type;
        }

        function deleteProductConfirm(productId) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŸ')) {
                deleteProduct(productId);
            }
        }

        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Event Listeners
        adminLink.addEventListener('click', (e) => {
            e.preventDefault();
            openModal('loginModal');
        });

        logoutLink.addEventListener('click', (e) => {
            e.preventDefault();
            adminLogout();
        });

        document.getElementById('productType').addEventListener('change', updateDimensionsSelects);

        // Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„ÙŠ
        document.addEventListener('DOMContentLoaded', function() {
            loadProducts();
            loadOrders();
            
            // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø³Ù„Ø© Ù…Ù† Ø£ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¯ÙŠÙ…Ø©
            cart = [];
            localStorage.removeItem(STORAGE_KEYS.CART);
            updateCartDisplay();
        });
    </script>
</body>
</html> 
