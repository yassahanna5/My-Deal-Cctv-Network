<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mydeal - Ù†Ø¸Ø§Ù… ØªØ¬Ø§Ø±Ø© Ø§Ù„ÙˆØ±Ù‚ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
            --info: #17a2b8;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #333;
            line-height: 1.6;
        }

        .navbar-brand {
            font-weight: 700;
        }

        .logo-text {
            color: var(--primary);
        }

        .logo-accent {
            color: var(--secondary);
        }

        .section-title {
            position: relative;
            margin-bottom: 2rem;
            padding-bottom: 0.5rem;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 80px;
            height: 3px;
            background: linear-gradient(to right, var(--secondary), var(--primary));
            border-radius: 2px;
        }

        .card {
            border: none;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border-radius: 10px;
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        }

        .btn-primary {
            background-color: var(--secondary);
            border-color: var(--secondary);
        }

        .btn-primary:hover {
            background-color: #2980b9;
            border-color: #2980b9;
        }

        .btn-success {
            background-color: var(--success);
            border-color: var(--success);
        }

        .btn-warning {
            background-color: var(--warning);
            border-color: var(--warning);
        }

        .btn-danger {
            background-color: var(--accent);
            border-color: var(--accent);
        }

        .btn-whatsapp {
            background-color: #25D366;
            border-color: #25D366;
            color: white;
        }

        .btn-whatsapp:hover {
            background-color: #128C7E;
            border-color: #128C7E;
            color: white;
        }

        .price-display {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            padding: 1.5rem;
            border-right: 4px solid var(--secondary);
        }

        .price-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent);
        }

        .dimension-card {
            background: white;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            text-align: center;
        }

        .dimension-card span {
            font-weight: 600;
            color: var(--primary);
        }

        .calculation-steps {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            border-right: 4px solid var(--success);
        }

        /* ğŸ”¥ Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª - ØªØ¸Ù‡Ø± Ø¯Ø§Ø¦Ù…Ø§Ù‹ ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰ */
        .notification {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 9999;
            max-width: 350px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border-radius: 8px;
            display: none;
        }

        .product-image-container {
            height: 200px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f8f9fa;
        }

        .product-image-container img {
            max-height: 100%;
            width: auto;
            object-fit: contain;
        }

        .no-image {
            width: 100%;
            height: 150px;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
            color: #6c757d;
            flex-direction: column;
        }

        .no-image i {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .image-upload {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            margin-bottom: 15px;
            cursor: pointer;
            transition: var(--transition);
        }

        .image-upload:hover {
            border-color: var(--secondary);
        }

        .image-preview {
            max-width: 100%;
            max-height: 200px;
            margin-top: 10px;
            display: none;
            border-radius: 5px;
        }

        .cart-item {
            border-bottom: 1px solid #eee;
            padding: 1rem 0;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .payment-step {
            text-align: center;
            padding: 1.5rem;
            border-radius: 10px;
            background: white;
            height: 100%;
            transition: var(--transition);
        }

        .payment-step:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .step-icon {
            font-size: 2.5rem;
            color: var(--secondary);
            margin-bottom: 1rem;
        }

        .vodafone-number {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--accent);
            margin: 10px 0;
            direction: ltr;
        }

        .stats-card {
            text-align: center;
            padding: 1.5rem;
            border-radius: 10px;
            background: white;
            height: 100%;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--secondary);
        }

        .footer {
            background: linear-gradient(135deg, var(--primary) 0%, var(--dark) 100%);
            color: white;
            padding: 2rem 0;
            margin-top: 3rem;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 2rem;
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--secondary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .image-options {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .image-option-btn {
            flex: 1;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            background: white;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
        }

        .image-option-btn.active {
            border-color: var(--secondary);
            background: var(--secondary);
            color: white;
        }

        .image-url-input {
            display: none;
        }

        .coupon-section {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .discount-info {
            margin-top: 10px;
            padding: 10px;
            background: white;
            border-radius: 5px;
            display: none;
        }

        .discount-applied {
            border-right: 4px solid var(--success);
        }

        .discount-error {
            border-right: 4px solid var(--accent);
        }

        .customer-info-section {
            background: #e8f4fd;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            border-right: 4px solid var(--secondary);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <i class="fas fa-scroll text-primary me-2"></i>
                <span class="logo-text">Mydeal </span> <span class="logo-accent">Ù„ØªØ¬Ø§Ø±Ø© Ø§Ù„ÙˆØ±Ù‚ </span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#products">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#payment">Ø§Ù„Ø¯ÙØ¹</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="adminLink">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="logoutLink" style="display: none;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Notifications - Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø­Ø³Ù†Ø© -->
    <div class="notification" id="notification">
        <div class="d-flex align-items-center">
            <i class="fas fa-bell me-2"></i>
            <span id="notification-text"></span>
            <button type="button" class="btn-close ms-auto" onclick="hideNotification()"></button>
        </div>
    </div>

    <!-- Loading -->
    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
        <p class="mt-2">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
    </div>

    <!-- Login Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="adminEmail" class="form-label">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                        <input type="email" id="adminEmail" class="form-control" placeholder="your admin email">
                    </div>
                    <div class="mb-3">
                        <label for="adminPassword" class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                        <input type="password" id="adminPassword" class="form-control" placeholder="your admin password">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="adminLogin()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Product Modal -->
    <div class="modal fade" id="addProductModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="newProductName" class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</label>
                        <input type="text" id="newProductName" class="form-control">
                    </div>
                    <div class="mb-3">
                        <label for="newProductType" class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬</label>
                        <select id="newProductType" class="form-control">
                            <option value="thermal">ÙˆØ±Ù‚ Ø­Ø±Ø§Ø±ÙŠ</option>
                            <option value="wax">Ø±ÙŠØ¨ÙˆÙ† Ø´Ù…Ø¹ÙŠ</option>
                            <option value="resin">Ø±ÙŠØ¨ÙˆÙ† Ø±ÙŠØ²ÙŠÙ†</option>
                            <option value="wax-resin">Ø±ÙŠØ¨ÙˆÙ† Ø´Ù…Ø¹ÙŠ Ø±ÙŠØ²ÙŠÙ†</option>
                            <option value="white">ÙˆØ±Ù‚ Ø£Ø¨ÙŠØ¶ Ù†ØµÙ Ù„Ø§Ù…Ø¹</option>
                            <option value="plastic">Ø¨Ù„Ø§Ø³ØªÙŠÙƒ</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="newProductPrice" class="form-label">Ø³Ø¹Ø± Ø§Ù„Ù…ØªØ± (Ø¬Ù†ÙŠÙ‡)</label>
                        <input type="number" id="newProductPrice" class="form-control" step="0.01">
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬</label>
                        <div class="image-options">
                            <div class="image-option-btn active" id="localImageBtn" onclick="switchImageOption('local')">
                                <i class="fas fa-upload"></i>
                                <div>Ø±ÙØ¹ Ù…Ù† Ø§Ù„Ø¬Ù‡Ø§Ø²</div>
                            </div>
                            <div class="image-option-btn" id="urlImageBtn" onclick="switchImageOption('url')">
                                <i class="fas fa-link"></i>
                                <div>Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø©</div>
                            </div>
                        </div>
                        
                        <!-- Ø±ÙØ¹ Ù…Ù† Ø§Ù„Ø¬Ù‡Ø§Ø² -->
                        <div id="localImageSection">
                            <div class="image-upload" onclick="document.getElementById('newProductImage').click()">
                                <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; color: #ccc; margin-bottom: 10px;"></i>
                                <p>Ø§Ù†Ù‚Ø± Ù„Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ</p>
                                <img id="newProductImagePreview" class="image-preview">
                            </div>
                            <input type="file" id="newProductImage" accept="image/*" style="display: none;" onchange="previewNewImage(this)">
                        </div>
                        
                        <!-- Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© -->
                        <div id="urlImageSection" style="display: none;">
                            <input type="url" id="newProductImageUrl" class="form-control" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (https://...)">
                            <div class="mt-2">
                                <button type="button" class="btn btn-warning" onclick="previewUrlImage()">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ±Ø©</button>
                            </div>
                            <img id="newProductUrlPreview" class="image-preview">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" onclick="addProduct()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Product Modal -->
    <div class="modal fade" id="editModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="editProductName" class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</label>
                        <input type="text" id="editProductName" class="form-control">
                    </div>
                    <div class="mb-3">
                        <label for="editProductType" class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬</label>
                        <select id="editProductType" class="form-control">
                            <option value="thermal">ÙˆØ±Ù‚ Ø­Ø±Ø§Ø±ÙŠ</option>
                            <option value="wax">Ø±ÙŠØ¨ÙˆÙ† Ø´Ù…Ø¹ÙŠ</option>
                            <option value="resin">Ø±ÙŠØ¨ÙˆÙ† Ø±ÙŠØ²ÙŠÙ†</option>
                            <option value="wax-resin">Ø±ÙŠØ¨ÙˆÙ† Ø´Ù…Ø¹ÙŠ Ø±ÙŠØ²ÙŠÙ†</option>
                            <option value="white">ÙˆØ±Ù‚ Ø£Ø¨ÙŠØ¶ Ù†ØµÙ Ù„Ø§Ù…Ø¹</option>
                            <option value="plastic">Ø¨Ù„Ø§Ø³ØªÙŠÙƒ</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="editProductPrice" class="form-label">Ø³Ø¹Ø± Ø§Ù„Ù…ØªØ± (Ø¬Ù†ÙŠÙ‡)</label>
                        <input type="number" id="editProductPrice" class="form-control" step="0.01">
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬</label>
                        <div class="image-options">
                            <div class="image-option-btn active" id="editLocalImageBtn" onclick="switchEditImageOption('local')">
                                <i class="fas fa-upload"></i>
                                <div>Ø±ÙØ¹ Ù…Ù† Ø§Ù„Ø¬Ù‡Ø§Ø²</div>
                            </div>
                            <div class="image-option-btn" id="editUrlImageBtn" onclick="switchEditImageOption('url')">
                                <i class="fas fa-link"></i>
                                <div>Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø©</div>
                            </div>
                        </div>
                        
                        <!-- Ø±ÙØ¹ Ù…Ù† Ø§Ù„Ø¬Ù‡Ø§Ø² -->
                        <div id="editLocalImageSection">
                            <div class="image-upload" onclick="document.getElementById('editProductImage').click()">
                                <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; color: #ccc; margin-bottom: 10px;"></i>
                                <p>Ø§Ù†Ù‚Ø± Ù„ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØ±Ø© Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ</p>
                                <p style="font-size: 12px; color: #666;">Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:</p>
                                <img id="editProductImagePreview" class="image-preview">
                            </div>
                            <input type="file" id="editProductImage" accept="image/*" style="display: none;" onchange="previewEditImage(this)">
                        </div>
                        
                        <!-- Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© -->
                        <div id="editUrlImageSection" style="display: none;">
                            <input type="url" id="editProductImageUrl" class="form-control" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (https://...)">
                            <div class="mt-2">
                                <button type="button" class="btn btn-warning" onclick="previewEditUrlImage()">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ±Ø©</button>
                            </div>
                            <img id="editProductUrlPreview" class="image-preview">
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="editProductActive" class="form-label">Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù†ØªØ¬</label>
                        <select id="editProductActive" class="form-control">
                            <option value="true">Ù†Ø´Ø·</option>
                            <option value="false">ØºÙŠØ± Ù†Ø´Ø·</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" onclick="updateProduct()">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Coupon Management Modal -->
    <div class="modal fade" id="couponModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Ø¥Ø¯Ø§Ø±Ø© ÙƒÙˆØ¨ÙˆÙ†Ø§Øª Ø§Ù„Ø®ØµÙ…</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="newCouponCode" class="form-label">ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…</label>
                        <input type="text" id="newCouponCode" class="form-control" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…">
                    </div>
                    <div class="mb-3">
                        <label for="newCouponDiscount" class="form-label">Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ… (%)</label>
                        <select id="newCouponDiscount" class="form-control">
                            <option value="5">5%</option>
                            <option value="10">10%</option>
                        </select>
                    </div>
                    <button class="btn btn-success w-100" onclick="addCoupon()">Ø¥Ø¶Ø§ÙØ© ÙƒÙˆØ¨ÙˆÙ†</button>
                    
                    <div id="couponsList" class="mt-4" style="max-height: 300px; overflow-y: auto;">
                        <h5>Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h5>
                        <div id="couponsContainer"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥ØºÙ„Ø§Ù‚</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <section id="home" class="py-5">
        <div class="container">
            <div class="text-center mb-5">
                <h2 class="section-title d-inline-block">Ù…ØªØ¬Ø± ÙˆØ±Ù‚ ÙˆØ§Ø³ØªÙŠÙƒØ±Ø§Øª MyDeal</h2>
                <p class="lead">ØªØ³ÙˆÙ‚ ÙˆØ§Ø´ØªØ±ÙŠ Ø§Ù„Ø§Ù† Ø¨Ø§Ø³Ø¹Ø§Ø± ØªÙ†Ø§ÙØ³ÙŠØ©</p>
            </div>

            <div class="card shadow">
                <div class="card-body p-4">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="productType" class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬</label>
                            <select id="productType" class="form-select">
                                <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="quantity" class="form-label">Ø§Ù„ÙƒÙ…ÙŠØ© (Ø§Ø³ØªÙŠÙƒØ±)</label>
                            <select id="quantity" class="form-select">
                                <option value="1000">1000 Ø§Ø³ØªÙŠÙƒØ± (Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¹Ø§Ø¯ÙŠ)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="length" class="form-label">Ø§Ù„Ø·ÙˆÙ„ (Ø³Ù…)</label>
                            <select id="length" class="form-select">
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø·ÙˆÙ„</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="width" class="form-label">Ø§Ù„Ø¹Ø±Ø¶ (Ø³Ù…)</label>
                            <select id="width" class="form-select">
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¹Ø±Ø¶</option>
                            </select>
                        </div>
                    </div>

                    <button class="btn btn-primary w-100 mb-4" onclick="addToCart()">Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©</button>

                    <!-- Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚ -->
                    <div class="card mb-4" id="cartItems" style="display: none;">
                        <div class="card-header bg-light">
                            <h5 class="mb-0">Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚</h5>
                        </div>
                        <div class="card-body">
                            <div id="cartItemsList"></div>
                            <div class="cart-total mt-3 pt-3 border-top">
                                <h5 class="text-center">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: <span id="cartTotalPrice" class="text-primary">0</span> Ø¬Ù†ÙŠÙ‡</h5>
                            </div>
                        </div>
                    </div>

                    <!-- Ù‚Ø³Ù… Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª -->
                    <div class="coupon-section">
                        <h5 class="mb-3">ÙƒÙˆØ¨ÙˆÙ† Ø§Ù„Ø®ØµÙ…</h5>
                        <div class="d-flex gap-2 mb-3">
                            <input type="text" id="couponCode" class="form-control" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…">
                            <button class="btn btn-warning" onclick="applyCoupon()">ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø®ØµÙ…</button>
                        </div>
                        <div class="discount-info" id="discountInfo"></div>
                    </div>

                    <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª -->
                    <div class="mt-4">
                        <label for="orderNotes" class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                        <textarea id="orderNotes" class="form-control" placeholder="Ø£Ø¯Ø®Ù„ Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø­ÙˆÙ„ Ø·Ù„Ø¨Ùƒ..." rows="3"></textarea>
                    </div>

                    <!-- Ù‚Ø³Ù… ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø´ØªØ±ÙŠ -->
                    <div class="customer-info-section mt-4">
                        <h5 class="mb-3">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø´ØªØ±ÙŠ ÙˆØ§Ù„Ø´Ø­Ù†</h5>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="customerName" class="form-label">Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ *</label>
                                <input type="text" id="customerName" class="form-control" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="customerPhone" class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ *</label>
                                <input type="tel" id="customerPhone" class="form-control" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="customerEmail" class="form-label">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ *</label>
                                <input type="email" id="customerEmail" class="form-control" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="customerGovernorate" class="form-label">Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© *</label>
                                <input type="text" id="customerGovernorate" class="form-control" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="customerCenter" class="form-label">Ø§Ù„Ù…Ø±ÙƒØ² *</label>
                                <input type="text" id="customerCenter" class="form-control" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="customerVillage" class="form-label">Ø§Ù„Ù‚Ø±ÙŠØ© / Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© *</label>
                                <input type="text" id="customerVillage" class="form-control" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="customerStreet" class="form-label">Ø§Ø³Ù… Ø§Ù„Ø´Ø§Ø±Ø¹ *</label>
                                <input type="text" id="customerStreet" class="form-control" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="customerPostalCode" class="form-label">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¨Ø±ÙŠØ¯ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                                <input type="text" id="customerPostalCode" class="form-control">
                            </div>
                        </div>
                    </div>

                    <!-- Ø²Ø± Ø§Ø­ØªØ³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ -->
                    <button class="btn btn-success w-100 mt-4 py-3" onclick="calculateTotalPrice()">
                        <i class="fas fa-calculator me-2"></i> Ø§Ø­Ø³Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ ÙˆØ£Ø±Ø³Ù„ Ø§Ù„Ø·Ù„Ø¨ (Ù„Ø§Ø²Ù… ÙˆØ§Ø¬Ø¨Ø§Ø±ÙŠ Ù„Ø§Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ù„Ù„Ø´Ø±ÙƒØ©)
                    </button>

                    <div class="price-display mt-4">
                        <h3 class="mb-3">Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</h3>
                        <div class="price-value text-center mb-3" id="priceValue">0 Ø¬Ù†ÙŠÙ‡</div>
                        <div class="row text-center">
                            <div class="col-md-6 mb-2">
                                <div class="dimension-card">
                                    Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: <span id="selectedItemsCount">0</span>
                                </div>
                            </div>
                            <div class="col-md-6 mb-2">
                                <div class="dimension-card">
                                    Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: <span id="selectedTotalPrice">0</span> Ø¬Ù†ÙŠÙ‡
                                </div>
                            </div>
                        </div>
                        
                        <div class="calculation-steps" id="calculationSteps" style="display: none;">
                            <h5 class="mb-3">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨:</h5>
                            <div id="stepsContent"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section id="products" class="py-5 bg-light">
        <div class="container">
            <div class="text-center mb-5">
                <h2 class="section-title d-inline-block">Ù…Ù†ØªØ¬Ø§ØªÙ†Ø§</h2>
                <p class="lead">Ø§Ø³ØªÙƒØ´Ù ØªØ´ÙƒÙŠÙ„ØªÙ†Ø§ Ø§Ù„ÙˆØ§Ø³Ø¹Ø© Ù…Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</p>
            </div>
            <div class="row g-4" id="productsGrid">
                <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù‡Ù†Ø§ -->
            </div>
        </div>
    </section>

    <!-- Payment Section -->
    <section id="payment" class="py-5">
        <div class="container">
            <div class="text-center mb-5">
                <h2 class="section-title d-inline-block">Ø§Ù„Ø¯ÙØ¹ Ø¹Ø¨Ø± ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´</h2>
                <p class="lead">Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ£Ù…Ø§Ù†</p>
            </div>

            <div class="card shadow">
                <div class="card-body p-4">
                    <div class="row g-4">
                        <div class="col-md-6 col-lg-3">
                            <div class="payment-step">
                                <div class="step-icon">
                                    <i class="fas fa-calculator"></i>
                                </div>
                                <h5>Ø§Ù„Ø®Ø·ÙˆØ© 1</h5>
                                <p>Ø§Ø­Ø³Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø£Ø¹Ù„Ø§Ù‡</p>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3">
                            <div class="payment-step">
                                <div class="step-icon">
                                    <i class="fas fa-mobile-alt"></i>
                                </div>
                                <h5>Ø§Ù„Ø®Ø·ÙˆØ© 2</h5>
                                <p>Ù‚Ù… Ø¨Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ø±Ù‚Ù… ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´ Ø§Ù„ØªØ§Ù„ÙŠ:</p>
                                <div class="vodafone-number">01008559292</div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3">
                            <div class="payment-step">
                                <div class="step-icon">
                                    <i class="fab fa-whatsapp"></i>
                                </div>
                                <h5>Ø§Ù„Ø®Ø·ÙˆØ© 3</h5>
                                <p>Ø£Ø±Ø³Ù„ Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯ÙØ¹ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</p>
                                <button class="btn btn-whatsapp mt-2" id="whatsappBtn" onclick="sendWhatsAppMessage()">
                                    <i class="fab fa-whatsapp me-2"></i> Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨
                                </button>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3">
                            <div class="payment-step">
                                <div class="step-icon">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <h5>Ø§Ù„Ø®Ø·ÙˆØ© 4</h5>
                                <p>Ø³Ù†Ù‚ÙˆÙ… Ø¨ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨Ùƒ ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡ Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Admin Section -->
    <section id="adminSection" class="py-5" style="display: none;">
        <div class="container">
            <div class="text-center mb-5">
                <h2 class="section-title d-inline-block">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>
                <p class="lead">Ø¥Ø¯Ø§Ø±Ø© ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø± ÙˆØ§Ù„Ø·Ù„Ø¨Ø§Øª</p>
            </div>

            <div class="card shadow">
                <div class="card-body p-4">
                    <div class="row g-4 mb-4">
                        <div class="col-md-3">
                            <div class="stats-card">
                                <div class="stat-number" id="totalProducts">0</div>
                                <div>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-card">
                                <div class="stat-number" id="totalOrders">0</div>
                                <div>Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-card">
                                <div class="stat-number" id="totalRevenue">0</div>
                                <div>Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª (Ø¬Ù†ÙŠÙ‡)</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-card">
                                <div class="stat-number" id="totalCoupons">0</div>
                                <div>ÙƒÙˆØ¨ÙˆÙ†Ø§Øª Ø§Ù„Ø®ØµÙ…</div>
                            </div>
                        </div>
                    </div>

                    <div class="d-flex gap-2 mb-4">
                        <button class="btn btn-success" onclick="openModal('couponModal')">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª</button>
                        <button class="btn btn-warning" onclick="openModal('addProductModal')">Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</button>
                    </div>

                    <div id="productsList" class="mt-4">
                        <h5 class="mb-3">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h5>
                        <div id="productsContainer"></div>
                    </div>

                    <div id="ordersList" class="mt-5">
                        <h5 class="mb-3">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h5>
                        <div id="ordersContainer"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container text-center">
            <h4 class="mb-3">Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ù…Ø¹ Ø§Ù„Ø´Ø±ÙƒØ© 01008559292 Ø¹Ù„ÙŠ Ø§Ù„ÙˆØ§ØªØ³</h4>
            <h5 class="mb-3" style="color: #ffcc00;">powerd by Eng.yassa hanna ÙˆØ§ØªØ³ 01016447253</h5>
            <h5>All rights resaved for My Deal Cctv & Network Â© 2025</h5>
        </div>
    </footer>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // ğŸ”¥ Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBznBqyjqA87Jp7hQakRgg4okOk6eXxw1E",
            authDomain: "mydeal-6b90d.firebaseapp.com",
            databaseURL: "https://mydeal-6b90d-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "mydeal-6b90d",
            storageBucket: "mydeal-6b90d.firebasestorage.app",
            messagingSenderId: "1026430553997",
            appId: "1:1026430553997:web:3f66722a15a0f87cf9b7c4",
            measurementId: "G-QL9K1RRTL2"
        };

        // Initialize Firebase
        let db, storage;
        try {
            firebase.initializeApp(firebaseConfig);
            console.log('âœ… Firebase initialized successfully');
            db = firebase.firestore();
            storage = firebase.storage();
        } catch (error) {
            console.error('âŒ Firebase initialization error:', error);
            showNotification('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', true);
        }

        // Global Variables
        let products = [];
        let orders = [];
        let coupons = [];
        let isAdminLoggedIn = false;
        let currentUser = null;
        let currentOrder = null;
        let currentEditingProduct = null;
        let appliedCoupon = null;
        let cart = [];
        let currentImageOption = 'local'; // 'local' or 'url'
        let currentEditImageOption = 'local';

        // DOM Elements
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notification-text');
        const loadingElement = document.getElementById('loading');
        const adminSection = document.getElementById('adminSection');
        const adminLink = document.getElementById('adminLink');
        const logoutLink = document.getElementById('logoutLink');
        const whatsappBtn = document.getElementById('whatsappBtn');

        // ğŸ”¥ Ø¯ÙˆØ§Ù„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙˆØ±
        function switchImageOption(option) {
            currentImageOption = option;
            const localBtn = document.getElementById('localImageBtn');
            const urlBtn = document.getElementById('urlImageBtn');
            const localSection = document.getElementById('localImageSection');
            const urlSection = document.getElementById('urlImageSection');

            if (option === 'local') {
                localBtn.classList.add('active');
                urlBtn.classList.remove('active');
                localSection.style.display = 'block';
                urlSection.style.display = 'none';
            } else {
                localBtn.classList.remove('active');
                urlBtn.classList.add('active');
                localSection.style.display = 'none';
                urlSection.style.display = 'block';
            }
        }

        function switchEditImageOption(option) {
            currentEditImageOption = option;
            const localBtn = document.getElementById('editLocalImageBtn');
            const urlBtn = document.getElementById('editUrlImageBtn');
            const localSection = document.getElementById('editLocalImageSection');
            const urlSection = document.getElementById('editUrlImageSection');

            if (option === 'local') {
                localBtn.classList.add('active');
                urlBtn.classList.remove('active');
                localSection.style.display = 'block';
                urlSection.style.display = 'none';
            } else {
                localBtn.classList.remove('active');
                urlBtn.classList.add('active');
                localSection.style.display = 'none';
                urlSection.style.display = 'block';
            }
        }

        function previewUrlImage() {
            const url = document.getElementById('newProductImageUrl').value;
            const preview = document.getElementById('newProductUrlPreview');
            
            if (url) {
                preview.src = url;
                preview.style.display = 'block';
                preview.onerror = function() {
                    showNotification('âŒ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© ØºÙŠØ± ØµØ§Ù„Ø­', true);
                    preview.style.display = 'none';
                };
            }
        }

        function previewEditUrlImage() {
            const url = document.getElementById('editProductImageUrl').value;
            const preview = document.getElementById('editProductUrlPreview');
            
            if (url) {
                preview.src = url;
                preview.style.display = 'block';
                preview.onerror = function() {
                    showNotification('âŒ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© ØºÙŠØ± ØµØ§Ù„Ø­', true);
                    preview.style.display = 'none';
                };
            }
        }

        // ğŸ”¥ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ
        function setupRealtimeUpdates() {
            console.log('ğŸ”„ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ©...');
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ
            db.collection('products').onSnapshot((snapshot) => {
                console.log('ğŸ“¦ ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:', snapshot.docs.length);
                products = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                populateProductSelect();
                loadProductsGrid();
                if (isAdminLoggedIn) {
                    loadAdminProducts();
                    updateStats();
                }
            }, (error) => {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:', error);
            });

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ
            db.collection('orders').onSnapshot((snapshot) => {
                console.log('ğŸ“‹ ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨Ø§Øª:', snapshot.docs.length);
                orders = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                if (isAdminLoggedIn) {
                    loadAdminOrders();
                    updateStats();
                }
            }, (error) => {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨Ø§Øª:', error);
            });

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ
            db.collection('coupons').onSnapshot((snapshot) => {
                console.log('ğŸ« ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª:', snapshot.docs.length);
                coupons = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                if (isAdminLoggedIn) {
                    loadAdminCoupons();
                    updateStats();
                }
            }, (error) => {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª:', error);
            });
        }

        // ğŸ”¥ Firebase Functions
        async function loadProducts() {
            try {
                showLoading();
                console.log('ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...');
                const snapshot = await db.collection('products').get();
                products = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                
                console.log('âœ… Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø­Ù…Ù„Ø©:', products.length);
                
                if (products.length === 0) {
                    console.log('ğŸ“ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§ØªØŒ Ø¬Ø§Ø±ÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©...');
                    await addDefaultProducts();
                }
                
                populateProductSelect();
                loadProductsGrid();
                if (isAdminLoggedIn) {
                    loadAdminProducts();
                    updateStats();
                }
                
                // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ©
                setupRealtimeUpdates();
            } catch (error) {
                console.error('âŒ Error loading products:', error);
                showNotification('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª', true);
                products = [];
                populateProductSelect();
            } finally {
                hideLoading();
            }
        }

        async function addDefaultProducts() {
            const defaultProducts = [
                { 
                    name: 'ÙˆØ±Ù‚ Ø­Ø±Ø§Ø±ÙŠ Ø¹Ø§Ø¯ÙŠ', 
                    type: 'thermal', 
                    price: 32, 
                    active: true,
                    imageUrl: '',
                    createdAt: new Date().toISOString() 
                },
                { 
                    name: 'ÙˆØ±Ù‚ Ø£Ø¨ÙŠØ¶ Ù†ØµÙ Ù„Ø§Ù…Ø¹', 
                    type: 'white', 
                    price: 28, 
                    active: true,
                    imageUrl: '',
                    createdAt: new Date().toISOString() 
                },
                { 
                    name: 'Ø¨Ù„Ø§Ø³ØªÙŠÙƒ', 
                    type: 'plastic', 
                    price: 45, 
                    active: true,
                    imageUrl: '',
                    createdAt: new Date().toISOString() 
                },
                { 
                    name: 'Ø±ÙŠØ¨ÙˆÙ† Ø´Ù…Ø¹ÙŠ', 
                    type: 'wax', 
                    price: 11, 
                    active: true,
                    imageUrl: '',
                    createdAt: new Date().toISOString() 
                },
                { 
                    name: 'Ø±ÙŠØ¨ÙˆÙ† Ø±ÙŠØ²ÙŠÙ†', 
                    type: 'resin', 
                    price: 15, 
                    active: true,
                    imageUrl: '',
                    createdAt: new Date().toISOString() 
                },
                { 
                    name: 'Ø±ÙŠØ¨ÙˆÙ† Ø´Ù…Ø¹ÙŠ Ø±ÙŠØ²ÙŠÙ†', 
                    type: 'wax-resin', 
                    price: 18, 
                    active: true,
                    imageUrl: '',
                    createdAt: new Date().toISOString() 
                }
            ];

            try {
                console.log('â• Ø¬Ø§Ø±ÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©...');
                for (const product of defaultProducts) {
                    await db.collection('products').add(product);
                    console.log('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ©:', product.name);
                }
                console.log('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
            } catch (error) {
                console.error('âŒ Error adding default products:', error);
            }
        }

        // ğŸ”¥ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©
        function loadProductsGrid() {
            const grid = document.getElementById('productsGrid');
            grid.innerHTML = '';

            if (products.length === 0) {
                grid.innerHTML = '<div class="col-12 text-center py-5"><h5>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</h5></div>';
                return;
            }

            products.filter(p => p.active).forEach(product => {
                const productItem = document.createElement('div');
                productItem.className = 'col-md-6 col-lg-4';
                productItem.innerHTML = `
                    <div class="card h-100">
                        <div class="product-image-container">
                            ${product.imageUrl ? 
                                `<img src="${product.imageUrl}" alt="${product.name}" class="card-img-top" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPiR7cHJvZHVjdC5uYW1lfTwvdGV4dD48L3N2Zz4='">` : 
                                `<div class="no-image">
                                    <i class="fas fa-image"></i>
                                    <p>Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ±Ø©</p>
                                </div>`
                            }
                        </div>
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">${product.name}</h5>
                            <p class="card-text">${getProductTypeName(product.type)}</p>
                            <div class="product-price fw-bold text-primary fs-5 my-2"> </div>
                            <button class="btn btn-primary mt-auto" onclick="selectProduct('${product.type}')">Ø§Ø®ØªØ± Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬</button>
                        </div>
                    </div>
                `;
                grid.appendChild(productItem);
            });
        }

        function selectProduct(productType) {
            document.getElementById('productType').value = productType;
            updateDimensionsSelects();
            showNotification('ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù†ØªØ¬ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯');
        }

        async function addProduct() {
            const name = document.getElementById('newProductName').value;
            const type = document.getElementById('newProductType').value;
            const price = parseFloat(document.getElementById('newProductPrice').value);

            if (!name || !price) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', true);
                return;
            }

            let imageUrl = '';

            if (currentImageOption === 'local') {
                // Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© Ù…Ù† Ø§Ù„Ø¬Ù‡Ø§Ø²
                const imageFile = document.getElementById('newProductImage').files[0];
                if (imageFile) {
                    try {
                        showLoading();
                        console.log('ğŸ”¼ Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©...');
                        const storageRef = storage.ref();
                        const imageRef = storageRef.child(`products/${Date.now()}_${imageFile.name}`);
                        const snapshot = await imageRef.put(imageFile);
                        imageUrl = await snapshot.ref.getDownloadURL();
                        console.log('âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©:', imageUrl);
                    } catch (error) {
                        console.error('âŒ Error uploading image:', error);
                        showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©', true);
                        return;
                    } finally {
                        hideLoading();
                    }
                }
            } else {
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©
                imageUrl = document.getElementById('newProductImageUrl').value;
                if (!imageUrl) {
                    showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©', true);
                    return;
                }
            }

            const productData = {
                name: name,
                type: type,
                price: price,
                imageUrl: imageUrl,
                active: true,
                createdAt: new Date().toISOString()
            };

            try {
                showLoading();
                console.log('â• Ø¬Ø§Ø±ÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬...', productData);
                const docRef = await db.collection('products').add(productData);
                console.log('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­:', docRef.id);
                showNotification('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­');
                
                // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø­Ù‚ÙˆÙ„
                document.getElementById('newProductName').value = '';
                document.getElementById('newProductPrice').value = '';
                document.getElementById('newProductImage').value = '';
                document.getElementById('newProductImageUrl').value = '';
                document.getElementById('newProductImagePreview').style.display = 'none';
                document.getElementById('newProductUrlPreview').style.display = 'none';
                
                closeModal('addProductModal');
            } catch (error) {
                console.error('âŒ Error adding product:', error);
                showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬', true);
            } finally {
                hideLoading();
            }
        }

        function editProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) {
                showNotification('Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', true);
                return;
            }

            currentEditingProduct = product;

            document.getElementById('editProductName').value = product.name;
            document.getElementById('editProductType').value = product.type;
            document.getElementById('editProductPrice').value = product.price;
            document.getElementById('editProductActive').value = product.active.toString();

            // Ø¹Ø±Ø¶ ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            const imagePreview = document.getElementById('editProductImagePreview');
            const urlPreview = document.getElementById('editProductUrlPreview');
            if (product.imageUrl) {
                imagePreview.src = product.imageUrl;
                imagePreview.style.display = 'block';
                document.getElementById('editProductImageUrl').value = product.imageUrl;
            } else {
                imagePreview.style.display = 'none';
                urlPreview.style.display = 'none';
            }

            openModal('editModal');
        }

        async function updateProduct() {
            if (!currentEditingProduct) {
                showNotification('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù†ØªØ¬ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„', true);
                return;
            }

            const name = document.getElementById('editProductName').value;
            const type = document.getElementById('editProductType').value;
            const price = parseFloat(document.getElementById('editProductPrice').value);
            const active = document.getElementById('editProductActive').value === 'true';

            if (!name || !price) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', true);
                return;
            }

            let imageUrl = currentEditingProduct.imageUrl;

            if (currentEditImageOption === 'local') {
                // Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù…Ù† Ø§Ù„Ø¬Ù‡Ø§Ø²
                const imageFile = document.getElementById('editProductImage').files[0];
                if (imageFile) {
                    try {
                        showLoading();
                        console.log('ğŸ”¼ Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©...');
                        const storageRef = storage.ref();
                        const imageRef = storageRef.child(`products/${Date.now()}_${imageFile.name}`);
                        const snapshot = await imageRef.put(imageFile);
                        imageUrl = await snapshot.ref.getDownloadURL();
                        console.log('âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:', imageUrl);
                    } catch (error) {
                        console.error('âŒ Error uploading image:', error);
                        showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©', true);
                        return;
                    } finally {
                        hideLoading();
                    }
                }
            } else {
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯
                const newImageUrl = document.getElementById('editProductImageUrl').value;
                if (newImageUrl) {
                    imageUrl = newImageUrl;
                }
            }

            const updates = {
                name: name,
                type: type,
                price: price,
                imageUrl: imageUrl,
                active: active,
                updatedAt: new Date().toISOString()
            };

            try {
                showLoading();
                console.log('âœï¸ Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬...', updates);
                await db.collection('products').doc(currentEditingProduct.id).update(updates);
                console.log('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­');
                showNotification('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­');
                closeModal('editModal');
            } catch (error) {
                console.error('âŒ Error updating product:', error);
                showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬', true);
            } finally {
                hideLoading();
            }
        }

        async function deleteProduct(productId) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŸ')) return;

            try {
                showLoading();
                console.log('ğŸ—‘ï¸ Ø¬Ø§Ø±ÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬...', productId);
                await db.collection('products').doc(productId).delete();
                console.log('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­');
                showNotification('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­');
            } catch (error) {
                console.error('âŒ Error deleting product:', error);
                showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬', true);
            } finally {
                hideLoading();
            }
        }

        async function loadOrders() {
            try {
                console.log('ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª...');
                const snapshot = await db.collection('orders').orderBy('createdAt', 'desc').get();
                orders = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                console.log('âœ… Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø­Ù…Ù„Ø©:', orders.length);
                
                if (isAdminLoggedIn) {
                    loadAdminOrders();
                    updateStats();
                }
            } catch (error) {
                console.error('âŒ Error loading orders:', error);
            }
        }

        async function createOrder(orderData) {
            try {
                console.log('ğŸ’¾ Ø¬Ø§Ø±ÙŠ Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨...', orderData);
                const docRef = await db.collection('orders').add(orderData);
                console.log('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­:', docRef.id);
                showNotification('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
                currentOrder = orderData;
                
                // ğŸ”¥ Ø¥Ø±Ø³Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ø¨Ø¹Ø¯ Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨
                setTimeout(() => {
                    sendWhatsAppMessage();
                }, 1000);
                
            } catch (error) {
                console.error('âŒ Error creating order:', error);
                showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨', true);
            }
        }

        async function addCoupon() {
            const code = document.getElementById('newCouponCode').value.trim().toUpperCase();
            const discount = parseInt(document.getElementById('newCouponDiscount').value);

            if (!code) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…', true);
                return;
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø§Ù„ÙƒÙˆØ¯
            const existingCoupon = coupons.find(c => c.code === code);
            if (existingCoupon) {
                showNotification('ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹', true);
                return;
            }

            const couponData = {
                code: code,
                discount: discount,
                createdAt: new Date().toISOString(),
                active: true,
                used: false,
                usedBy: null,
                usedAt: null
            };

            try {
                console.log('â• Ø¬Ø§Ø±ÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†...', couponData);
                const docRef = await db.collection('coupons').add(couponData);
                console.log('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† Ø¨Ù†Ø¬Ø§Ø­:', docRef.id);
                showNotification('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© ÙƒÙˆØ¨ÙˆÙ† Ø§Ù„Ø®ØµÙ… Ø¨Ù†Ø¬Ø§Ø­');
                document.getElementById('newCouponCode').value = '';
            } catch (error) {
                console.error('âŒ Error adding coupon:', error);
                showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© ÙƒÙˆØ¨ÙˆÙ† Ø§Ù„Ø®ØµÙ…', true);
            }
        }

        async function deleteCoupon(couponId) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†ØŸ')) return;

            try {
                console.log('ğŸ—‘ï¸ Ø¬Ø§Ø±ÙŠ Ø­Ø°Ù Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†...', couponId);
                await db.collection('coupons').doc(couponId).delete();
                console.log('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† Ø¨Ù†Ø¬Ø§Ø­');
                showNotification('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† Ø¨Ù†Ø¬Ø§Ø­');
            } catch (error) {
                console.error('âŒ Error deleting coupon:', error);
                showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†', true);
            }
        }

        // ğŸ”¥ ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function populateProductSelect() {
            const select = document.getElementById('productType');
            select.innerHTML = '<option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬</option>';
            
            if (products.length === 0) {
                select.innerHTML = '<option value="">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù…ØªØ§Ø­Ø©</option>';
                return;
            }
            
            console.log('ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ¹Ø¨Ø¦Ø© Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...', products.length);
            
            products.filter(p => p.active).forEach(product => {
                const option = document.createElement('option');
                option.value = product.type;
                option.textContent = `${product.name}`;
                select.appendChild(option);
            });

            // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ù…Ù† 1 Ø¥Ù„Ù‰ 15 Ø³Ù…
            const lengthSelect = document.getElementById('length');
            const widthSelect = document.getElementById('width');
            
            lengthSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø·ÙˆÙ„</option>';
            widthSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¹Ø±Ø¶</option>';

            const dimensions = generateDimensions();
            dimensions.forEach(dim => {
                const lengthOption = document.createElement('option');
                lengthOption.value = dim;
                lengthOption.textContent = `${dim} Ø³Ù…`;
                lengthSelect.appendChild(lengthOption);

                const widthOption = document.createElement('option');
                widthOption.value = dim;
                widthOption.textContent = `${dim} Ø³Ù…`;
                widthSelect.appendChild(widthOption);
            });
        }

        function updateDimensionsSelects() {
            const productType = document.getElementById('productType').value;
            const lengthSelect = document.getElementById('length');
            const widthSelect = document.getElementById('width');
            const quantitySelect = document.getElementById('quantity');
            
            lengthSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø·ÙˆÙ„</option>';
            widthSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¹Ø±Ø¶</option>';
            
            if (!productType) {
                lengthSelect.disabled = true;
                widthSelect.disabled = true;
                return;
            }

            const product = products.find(p => p.type === productType);
            if (!product) return;

            lengthSelect.disabled = false;
            widthSelect.disabled = false;

            // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø£Ø·ÙˆØ§Ù„
            (product.lengths || generateDimensions()).forEach(length => {
                const option = document.createElement('option');
                option.value = length;
                option.textContent = `${length} Ø³Ù…`;
                lengthSelect.appendChild(option);
            });

            // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¹Ø±ÙˆØ¶
            (product.widths || generateDimensions()).forEach(width => {
                const option = document.createElement('option');
                option.value = width;
                option.textContent = `${width} Ø³Ù…`;
                widthSelect.appendChild(option);
            });

            // ØªØ­Ø¯ÙŠØ« Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ÙƒÙ…ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬
            updateQuantityOptions(productType);
        }

        // ğŸ”¥ ØªØ­Ø¯ÙŠØ« Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ÙƒÙ…ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬
        function updateQuantityOptions(productType) {
            const quantitySelect = document.getElementById('quantity');
            quantitySelect.innerHTML = '';
            
            // Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ÙˆØ±Ù‚ÙŠØ© ÙÙ‚Ø· ÙŠÙ…ÙƒÙ† Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ…ÙŠØ© 500ØŒ 1000ØŒ 2000
            if (['thermal', 'white', 'plastic'].includes(productType)) {
                quantitySelect.innerHTML = `
                    <option value="500">500 Ø§Ø³ØªÙŠÙƒØ± (Ù†ØµÙ Ø§Ù„Ø³Ø¹Ø±)</option>
                    <option value="1000" selected>1000 Ø§Ø³ØªÙŠÙƒØ± (Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¹Ø§Ø¯ÙŠ)</option>
                    <option value="2000">2000 Ø§Ø³ØªÙŠÙƒØ± (Ø¶Ø¹Ù Ø§Ù„Ø³Ø¹Ø±)</option>
                `;
            } else {
                // Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ ØºÙŠØ± Ø§Ù„ÙˆØ±Ù‚ÙŠØ© Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ…ÙŠØ©
                quantitySelect.innerHTML = '<option value="1000">1000 Ø§Ø³ØªÙŠÙƒØ± (Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¹Ø§Ø¯ÙŠ)</option>';
            }
        }

        // ğŸ”¥ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ù…Ù† 1 Ø¥Ù„Ù‰ 15 Ø³Ù…
        function generateDimensions() {
            const dimensions = [];
            for (let i = 1; i <= 15; i++) {
                dimensions.push(i);
            }
            return dimensions;
        }

        // ğŸ”¥ Ø¯Ø§Ù„Ø© Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©
        function addToCart() {
            const productType = document.getElementById('productType').value;
            const length = parseInt(document.getElementById('length').value);
            const width = parseInt(document.getElementById('width').value);
            const quantity = document.getElementById('quantity').value;

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            if (!productType || !length || !width) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', true);
                return;
            }

            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…Ø­Ø¯Ø¯
            const product = products.find(p => p.type === productType);
            if (!product) {
                showNotification('Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', true);
                return;
            }

            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬
            let price = calculateItemPrice(product, length, width, quantity);
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©
            const cartItem = {
                id: Date.now().toString(),
                productName: product.name,
                productType: productType,
                length: length,
                width: width,
                quantity: quantity,
                unitPrice: product.price,
                itemPrice: price,
                createdAt: new Date().toISOString()
            };

            cart.push(cartItem);
            updateCartDisplay();
            showNotification(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${product.name} Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©`);
        }

        // ğŸ”¥ Ø¯Ø§Ù„Ø© Ø­Ø³Ø§Ø¨ Ø³Ø¹Ø± Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„ÙˆØ§Ø­Ø¯ - Ø¨Ø¯Ù‚Ø© 100%
        function calculateItemPrice(product, length, width, quantity) {
            let price = 0;

            // Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ÙˆØ±Ù‚ÙŠØ©: thermal, white, plastic
            if (['thermal', 'white', 'plastic'].includes(product.type)) {
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‡ÙˆØ§Ù…Ø´ 3 Ù…Ù… Ù„Ù„Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ÙˆØ±Ù‚ÙŠØ© ÙÙ‚Ø·
                const lengthWithMargin = (length * 10) + 3; // Ø³Ù… Ø¥Ù„Ù‰ Ù…Ù… + 3 Ù…Ù…
                const widthWithMargin = (width * 10) + 3;   // Ø³Ù… Ø¥Ù„Ù‰ Ù…Ù… + 3 Ù…Ù…
                
                // Ø§Ù„Ø­Ø³Ø§Ø¨: (Ø§Ù„Ø·ÙˆÙ„ Ø¨Ø§Ù„Ù…Ù… Ã— Ø§Ù„Ø¹Ø±Ø¶ Ø¨Ø§Ù„Ù…Ù… Ã— Ø³Ø¹Ø± Ø§Ù„Ù…ØªØ±) Ã· 1000
                price = (lengthWithMargin * widthWithMargin * product.price)/1000 ;
                
                // Ù…Ø«Ø§Ù„: 10Ø³Ù… Ã— 15Ø³Ù… ÙˆØ±Ù‚ Ø­Ø±Ø§Ø±ÙŠ
                // 10Ø³Ù… = 1000Ù…Ù… + 3Ù…Ù… = 1003Ù…Ù…
                // 15Ø³Ù… = 1500Ù…Ù… + 3Ù…Ù… = 1503Ù…Ù…
                // Ø§Ù„Ø³Ø¹Ø± = (1003 Ã— 1503 Ã— 32) Ã· 1000 = 48,288 Ø¬Ù†ÙŠÙ‡ Ù„Ù„Ø£Ù„Ù Ø§Ø³ØªÙŠÙƒØ±
                
            } 
            // Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ ØºÙŠØ± Ø§Ù„ÙˆØ±Ù‚ÙŠØ©: wax, resin, wax-resin
            else if (['wax', 'resin', 'wax-resin'].includes(product.type)) {
                // Ø¨Ø¯ÙˆÙ† Ù‡ÙˆØ§Ù…Ø´ Ù„Ù„Ø£Ù†ÙˆØ§Ø¹ ØºÙŠØ± Ø§Ù„ÙˆØ±Ù‚ÙŠØ©
                const lengthMm = length * 10; // Ø³Ù… Ø¥Ù„Ù‰ Ù…Ù…
                const widthMm = width * 10;   // Ø³Ù… Ø¥Ù„Ù‰ Ù…Ù…
                
                // Ø§Ù„Ø­Ø³Ø§Ø¨: (Ø§Ù„Ø·ÙˆÙ„ Ø¨Ø§Ù„Ù…Ù… Ã— Ø§Ù„Ø¹Ø±Ø¶ Ø¨Ø§Ù„Ù…Ù… Ã— Ø³Ø¹Ø± Ø§Ù„Ù…ØªØ±)
                price = (lengthMm * widthMm * product.price)/100;
                
                // Ù…Ø«Ø§Ù„: 110Ø³Ù… Ã— 70Ù…ØªØ± Ø±ÙŠØ¨ÙˆÙ† Ø´Ù…Ø¹ÙŠ
                // 110Ø³Ù… = 11000Ù…Ù…
                // 70Ù…ØªØ± = 70000Ù…Ù…  
                // Ø§Ù„Ø³Ø¹Ø± = 11000 Ã— 70000 Ã— 11 = 84,700,000 Ø¬Ù†ÙŠÙ‡
            }

            // ØªØ·Ø¨ÙŠÙ‚ Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒÙ…ÙŠØ§Øª
            if (quantity === "500") {
                price = price / 2; // Ù†ØµÙ Ø§Ù„Ø³Ø¹Ø±
            } else if (quantity === "2000") {
                price = price * 2; // Ø¶Ø¹Ù Ø§Ù„Ø³Ø¹Ø±
            }

            return Math.round(price);
        }

        // ğŸ”¥ ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø³Ù„Ø©
        function updateCartDisplay() {
            const cartItemsList = document.getElementById('cartItemsList');
            const cartItemsContainer = document.getElementById('cartItems');
            
            if (cart.length === 0) {
                cartItemsList.innerHTML = '<div class="text-center py-3 text-muted">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</div>';
                cartItemsContainer.style.display = 'none';
                return;
            }

            cartItemsContainer.style.display = 'block';
            
            cartItemsList.innerHTML = cart.map(item => `
                <div class="cart-item">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="mb-1">${item.productName}</h6>
                            <p class="mb-1 text-muted">Ø§Ù„Ù…Ù‚Ø§Ø³: ${item.length} Ã— ${item.width} Ø³Ù…</p>
                            <p class="mb-0 text-muted">Ø§Ù„ÙƒÙ…ÙŠØ©: ${item.quantity} Ø§Ø³ØªÙŠÙƒØ±</p>
                            <p class="mb-0 fw-bold">Ø§Ù„Ø³Ø¹Ø±: ${item.itemPrice.toLocaleString()} Ø¬Ù†ÙŠÙ‡</p>
                        </div>
                        <button class="btn btn-danger btn-sm" onclick="removeFromCart('${item.id}')">Ø­Ø°Ù</button>
                    </div>
                </div>
            `).join('');

            updateCartTotal();
        }

        function removeFromCart(itemId) {
            cart = cart.filter(item => item.id !== itemId);
            updateCartDisplay();
            showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Ø§Ù„Ø³Ù„Ø©');
        }

        function updateCartTotal() {
            const totalPrice = cart.reduce((sum, item) => sum + item.itemPrice, 0);
            document.getElementById('cartTotalPrice').textContent = totalPrice.toLocaleString();
            document.getElementById('selectedItemsCount').textContent = cart.length;
            document.getElementById('selectedTotalPrice').textContent = totalPrice.toLocaleString();
        }

        function clearCart() {
            cart = [];
            updateCartDisplay();
            showNotification('ØªÙ… ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©');
        }

        function calculateTotalPrice() {
            if (cart.length === 0) {
                showNotification('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©', true);
                return;
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´ØªØ±ÙŠ
            const customerName = document.getElementById('customerName').value;
            const customerPhone = document.getElementById('customerPhone').value;
            const customerGovernorate = document.getElementById('customerGovernorate').value;
            const customerCenter = document.getElementById('customerCenter').value;
            const customerVillage = document.getElementById('customerVillage').value;
            const customerStreet = document.getElementById('customerStreet').value;

            if (!customerName || !customerPhone || !customerGovernorate || !customerCenter || !customerVillage || !customerStreet) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´ØªØ±ÙŠ Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ©', true);
                return;
            }

            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙƒÙ„ÙŠ
            let totalPrice = cart.reduce((sum, item) => sum + item.itemPrice, 0);
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø®ØµÙ… Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
            if (appliedCoupon) {
                const discountAmount = (totalPrice * appliedCoupon.discount / 100);
                totalPrice = totalPrice - discountAmount;
                
                // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† Ù„ÙŠÙƒÙˆÙ† Ù…Ø³ØªØ®Ø¯Ù…Ù‹Ø§
                updateCouponUsage(appliedCoupon.id, customerPhone);
            }

            // Ø¬Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´ØªØ±ÙŠ
            const customerInfo = {
                name: customerName,
                phone: customerPhone,
                email: document.getElementById('customerEmail').value,
                governorate: customerGovernorate,
                center: customerCenter,
                village: customerVillage,
                street: customerStreet,
                postalCode: document.getElementById('customerPostalCode').value
            };

            // Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„ÙƒÙ„ÙŠ
            const orderData = {
                items: [...cart],
                totalPrice: Math.round(totalPrice),
                coupon: appliedCoupon ? appliedCoupon.code : null,
                discount: appliedCoupon ? appliedCoupon.discount : 0,
                notes: document.getElementById('orderNotes').value,
                customerInfo: customerInfo,
                orderNumber: 'ORD-' + Date.now(),
                createdAt: new Date().toISOString()
            };
            
            currentOrder = orderData;
            
            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            document.getElementById('priceValue').textContent = Math.round(totalPrice).toLocaleString() + ' Ø¬Ù†ÙŠÙ‡';
            document.getElementById('calculationSteps').style.display = 'block';
            
            const stepsContent = document.getElementById('stepsContent');
            stepsContent.innerHTML = `
                <div class="step">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: ${cart.length}</div>
                ${cart.map(item => `
                    <div class="step">${item.productName}: ${item.length}Ã—${item.width} Ø³Ù… - ${item.quantity} Ø§Ø³ØªÙŠÙƒØ± - ${item.itemPrice.toLocaleString()} Ø¬Ù†ÙŠÙ‡</div>
                `).join('')}
                ${appliedCoupon ? `<div class="step">Ø§Ù„Ø®ØµÙ…: ${appliedCoupon.discount}%</div>` : ''}
                <div class="step">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: ${Math.round(totalPrice).toLocaleString()} Ø¬Ù†ÙŠÙ‡</div>
            `;

            showNotification(`ØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${Math.round(totalPrice).toLocaleString()} Ø¬Ù†ÙŠÙ‡`);
            
            // ğŸ”¥ Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ¥Ø±Ø³Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨
            createOrder(orderData);
            
        }

        // ğŸ”¥ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
        async function updateCouponUsage(couponId, customerPhone) {
            try {
                await db.collection('coupons').doc(couponId).update({
                    used: true,
                    usedBy: customerPhone,
                    usedAt: new Date().toISOString()
                });
                console.log('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…');
            } catch (error) {
                console.error('âŒ Error updating coupon usage:', error);
            }
        }

        // ğŸ”¥ Admin Functions
        function loadAdminProducts() {
            const container = document.getElementById('productsContainer');
            container.innerHTML = '';

            if (products.length === 0) {
                container.innerHTML = '<div class="text-center py-3 text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</div>';
                return;
            }

            console.log('ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©...', products.length);

            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'card mb-3';
                productCard.innerHTML = `
                    <div class="card-body">
                        <div class="row align-items-center">
                            <div class="col-md-2">
                                ${product.imageUrl ? 
                                    `<img src="${product.imageUrl}" class="img-fluid rounded" style="max-height: 100px;">` : 
                                    '<div class="no-image" style="width: 100px; height: 100px;"><i class="fas fa-image"></i></div>'
                                }
                            </div>
                            <div class="col-md-6">
                                <h5 class="card-title">${product.name}</h5>
                                <p class="card-text mb-1">Ø§Ù„Ù†ÙˆØ¹: ${getProductTypeName(product.type)}</p>
                                <p class="card-text mb-1">Ø§Ù„Ø³Ø¹Ø±: ${product.price} Ø¬Ù†ÙŠÙ‡ Ù„Ù„Ù…ØªØ±</p>
                                <p class="card-text mb-0">Ø§Ù„Ø­Ø§Ù„Ø©: <span class="badge ${product.active ? 'bg-success' : 'bg-danger'}">${product.active ? 'Ù†Ø´Ø·' : 'ØºÙŠØ± Ù†Ø´Ø·'}</span></p>
                            </div>
                            <div class="col-md-4 text-end">
                                <button class="btn btn-warning btn-sm me-2" onclick="editProduct('${product.id}')">ØªØ¹Ø¯ÙŠÙ„</button>
                                <button class="btn btn-danger btn-sm" onclick="deleteProductConfirm('${product.id}')">Ø­Ø°Ù</button>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(productCard);
            });
        }

        function loadAdminOrders() {
            const container = document.getElementById('ordersContainer');
            container.innerHTML = '';

            if (orders.length === 0) {
                container.innerHTML = '<div class="text-center py-3 text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</div>';
                return;
            }

            console.log('ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©...', orders.length);

            orders.forEach(order => {
                const orderCard = document.createElement('div');
                orderCard.className = 'card mb-3';
                
                if (order.items) {
                    // Ø·Ù„Ø¨ Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                    orderCard.innerHTML = `
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <h5 class="card-title mb-0">Ø·Ù„Ø¨ #${order.orderNumber}</h5>
                                <span class="badge bg-primary">${new Date(order.createdAt).toLocaleDateString('ar-EG')}</span>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <p class="mb-1"><strong>Ø§Ù„Ù…Ø´ØªØ±ÙŠ:</strong> ${order.customerInfo?.name || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                                    <p class="mb-1"><strong>Ø§Ù„Ù‡Ø§ØªÙ:</strong> ${order.customerInfo?.phone || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                                    ${order.customerInfo?.email ? `<p class="mb-1"><strong>Ø§Ù„Ø¨Ø±ÙŠØ¯:</strong> ${order.customerInfo.email}</p>` : ''}
                                </div>
                                <div class="col-md-6">
                                    <p class="mb-1"><strong>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</strong> ${order.customerInfo?.governorate || ''} - ${order.customerInfo?.center || ''}</p>
                                    <p class="mb-1"><strong>Ø§Ù„Ù‚Ø±ÙŠØ©/Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</strong> ${order.customerInfo?.village || ''}</p>
                                    <p class="mb-0"><strong>Ø§Ù„Ø´Ø§Ø±Ø¹:</strong> ${order.customerInfo?.street || ''}</p>
                                </div>
                            </div>
                            <div class="mb-3">
                                <h6>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:</h6>
                                <div class="table-responsive">
                                    <table class="table table-sm table-bordered">
                                        <thead class="table-light">
                                            <tr>
                                                <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
                                                <th>Ø§Ù„Ù…Ù‚Ø§Ø³</th>
                                                <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
                                                <th>Ø§Ù„Ø³Ø¹Ø±</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${order.items.map(item => `
                                                <tr>
                                                    <td>${item.productName}</td>
                                                    <td>${item.length}Ã—${item.width} Ø³Ù…</td>
                                                    <td>${item.quantity} Ø§Ø³ØªÙŠÙƒØ±</td>
                                                    <td>${item.itemPrice.toLocaleString()} Ø¬Ù†ÙŠÙ‡</td>
                                                </tr>
                                            `).join('')}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    ${order.coupon ? `<p><strong>ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…:</strong> ${order.coupon} (${order.discount}% Ø®ØµÙ…)</p>` : ''}
                                    ${order.notes ? `<p><strong>Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</strong> ${order.notes}</p>` : ''}
                                </div>
                                <div class="col-md-6 text-end">
                                    <h5 class="text-primary">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: ${order.totalPrice.toLocaleString()} Ø¬Ù†ÙŠÙ‡</h5>
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                container.appendChild(orderCard);
            });
        }

        function loadAdminCoupons() {
            const container = document.getElementById('couponsContainer');
            container.innerHTML = '';

            if (coupons.length === 0) {
                container.innerHTML = '<div class="text-center py-3 text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒÙˆØ¨ÙˆÙ†Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</div>';
                return;
            }

            console.log('ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©...', coupons.length);

            coupons.forEach(coupon => {
                const couponCard = document.createElement('div');
                couponCard.className = 'card mb-2';
                couponCard.innerHTML = `
                    <div class="card-body py-2">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-0">${coupon.code}</h6>
                                <p class="mb-0 text-muted">Ø®ØµÙ…: ${coupon.discount}%</p>
                                <p class="mb-0">
                                    <span class="badge ${coupon.active ? 'bg-success' : 'bg-danger'}">${coupon.active ? 'Ù†Ø´Ø·' : 'ØºÙŠØ± Ù†Ø´Ø·'}</span>
                                    ${coupon.used ? `<span class="badge bg-warning">Ù…Ø³ØªØ®Ø¯Ù…</span>` : ''}
                                </p>
                            </div>
                            <button class="btn btn-danger btn-sm" onclick="deleteCoupon('${coupon.id}')">Ø­Ø°Ù</button>
                        </div>
                    </div>
                `;
                container.appendChild(couponCard);
            });
        }

        function updateStats() {
            document.getElementById('totalProducts').textContent = products.length;
            document.getElementById('totalOrders').textContent = orders.length;
            document.getElementById('totalCoupons').textContent = coupons.length;
            const totalRevenue = orders.reduce((sum, order) => sum + order.totalPrice, 0);
            document.getElementById('totalRevenue').textContent = totalRevenue.toLocaleString();
        }

        // ğŸ”¥ Authentication
        function adminLogin() {
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;

            if (email === 'admin@mydeal.com' && password === 'admin123') {
                isAdminLoggedIn = true;
                currentUser = { email: email, role: 'admin' };
                closeModal('loginModal');
                adminSection.style.display = 'block';
                loadAdminProducts();
                loadAdminOrders();
                loadAdminCoupons();
                updateStats();
                adminLink.style.display = 'none';
                logoutLink.style.display = 'block';
            } else {
                alert('Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
            }
        }

        function adminLogout() {
            isAdminLoggedIn = false;
            currentUser = null;
            adminSection.style.display = 'none';
            adminLink.style.display = 'block';
            logoutLink.style.display = 'none';
            showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­');
        }

        // ğŸ”¥ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª
        function applyCoupon() {
            const code = document.getElementById('couponCode').value.trim().toUpperCase();
            const discountInfo = document.getElementById('discountInfo');
            const customerPhone = document.getElementById('customerPhone').value;
            
            if (!code) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…', true);
                return;
            }

            if (!customerPhone) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø£ÙˆÙ„Ø§Ù‹', true);
                return;
            }

            const coupon = coupons.find(c => c.code === code && c.active);
            if (!coupon) {
                discountInfo.innerHTML = '<p class="mb-0 text-danger">ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… ØºÙŠØ± ØµØ§Ù„Ø­ Ø£Ùˆ Ù…Ù†ØªÙ‡ÙŠ</p>';
                discountInfo.className = 'discount-info discount-error';
                discountInfo.style.display = 'block';
                appliedCoupon = null;
                return;
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† Ù…Ø³Ø¨Ù‚Ø§Ù‹
            if (coupon.used) {
                discountInfo.innerHTML = '<p class="mb-0 text-danger">ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¨Ù‚Ø§Ù‹</p>';
                discountInfo.className = 'discount-info discount-error';
                discountInfo.style.display = 'block';
                appliedCoupon = null;
                return;
            }

            appliedCoupon = coupon;
            discountInfo.innerHTML = `<p class="mb-0 text-success">ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø®ØµÙ… ${coupon.discount}% Ø¨Ù†Ø¬Ø§Ø­</p>`;
            discountInfo.className = 'discount-info discount-applied';
            discountInfo.style.display = 'block';
            showNotification(`ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø®ØµÙ… ${coupon.discount}% Ø¨Ù†Ø¬Ø§Ø­`);
        }

        // ğŸ”¥ Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ - ØªÙ… Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø±Ù‚Ù… ÙˆØ§Ù„ØªÙ†Ø³ÙŠÙ‚
        function sendWhatsAppMessage() {
            if (!currentOrder) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø£ÙˆÙ„Ø§Ù‹', true);
                return;
            }

            let message = `Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† MyDeal\n\n`;
            message += `Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${currentOrder.orderNumber}\n`;
            message += `Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toLocaleDateString('ar-EG')}\n\n`;
            
            message += `ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨:\n`;
            message += `=========================\n`;
            
            currentOrder.items.forEach((item, index) => {
                message += `${item.productName} - ${item.length}Ã—${item.width} Ø³Ù… - ${item.quantity} Ø§Ø³ØªÙŠÙƒØ± - ${item.itemPrice.toLocaleString()} Ø¬Ù†ÙŠÙ‡\n`;
            });
            
            message += `=========================\n\n`;
            
            message += `Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${currentOrder.totalPrice.toLocaleString()} Ø¬Ù†ÙŠÙ‡\n`;
            
            if (currentOrder.coupon) {
                message += `Ø§Ù„Ø®ØµÙ…: ${currentOrder.discount}% (ÙƒÙˆØ¯: ${currentOrder.coupon})\n`;
            }
            
            if (currentOrder.notes) {
                message += `Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${currentOrder.notes}\n`;
            }
            
            message += `\nÙ…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø´ØªØ±ÙŠ:\n`;
            message += `=========================\n`;
            message += `Ø§Ù„Ø§Ø³Ù…: ${currentOrder.customerInfo.name}\n`;
            message += `Ø§Ù„Ù‡Ø§ØªÙ: ${currentOrder.customerInfo.phone}\n`;
            if (currentOrder.customerInfo.email) {
                message += `Ø§Ù„Ø¨Ø±ÙŠØ¯: ${currentOrder.customerInfo.email}\n`;
            }
            message += `Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©: ${currentOrder.customerInfo.governorate}\n`;
            message += `Ø§Ù„Ù…Ø±ÙƒØ²: ${currentOrder.customerInfo.center}\n`;
            message += `Ø§Ù„Ù‚Ø±ÙŠØ©/Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©: ${currentOrder.customerInfo.village}\n`;
            message += `Ø§Ù„Ø´Ø§Ø±Ø¹: ${currentOrder.customerInfo.street}\n`;
            if (currentOrder.customerInfo.postalCode) {
                message += `Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¨Ø±ÙŠØ¯ÙŠ: ${currentOrder.customerInfo.postalCode}\n`;
            }
            message += `=========================\n\n`;
            
            message += `Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹: ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´\n`;
            message += `Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: 01008559292`;

             // ğŸ”¥ Ø¥ØµÙ„Ø§Ø­ Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨
            const phoneNumber = "201008559292"; // Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØµØ­ÙŠØ­ Ù…Ø¹ ÙƒÙˆØ¯ Ø§Ù„Ø¯ÙˆÙ„Ø©
            const encodedMessage = encodeURIComponent(message);
            const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodedMessage}`;
            
            window.open(whatsappUrl, '_blank');
            showNotification('Ø¬Ø§Ø±ÙŠ ÙØªØ­ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨...');
        }

 
        // ğŸ”¥ Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
        function getProductTypeName(type) {
            const types = {
                'thermal': 'ÙˆØ±Ù‚ Ø­Ø±Ø§Ø±ÙŠ',
                'wax': 'Ø±ÙŠØ¨ÙˆÙ† Ø´Ù…Ø¹ÙŠ', 
                'resin': 'Ø±ÙŠØ¨ÙˆÙ† Ø±ÙŠØ²ÙŠÙ†',
                'wax-resin': 'Ø±ÙŠØ¨ÙˆÙ† Ø´Ù…Ø¹ÙŠ Ø±ÙŠØ²ÙŠÙ†',
                'white': 'ÙˆØ±Ù‚ Ø£Ø¨ÙŠØ¶ Ù†ØµÙ Ù„Ø§Ù…Ø¹',
                'plastic': 'Ø¨Ù„Ø§Ø³ØªÙŠÙƒ'
            };
            return types[type] || type;
        }

        // ğŸ”¥ Ø¥ØµÙ„Ø§Ø­ Ø¯Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
        function showNotification(message, isError = false) {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notification-text');
            
            notificationText.textContent = message;
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
            if (isError) {
                notification.style.backgroundColor = '#f8d7da';
                notification.style.color = '#721c24';
                notification.style.border = '1px solid #f5c6cb';
            } else {
                notification.style.backgroundColor = '#d1edff';
                notification.style.color = '#0c5460';
                notification.style.border = '1px solid #bee5eb';
            }
            
            notification.style.display = 'block';
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ
            setTimeout(() => {
                hideNotification();
            }, 5000);
        }

        function hideNotification() {
            const notification = document.getElementById('notification');
            notification.style.display = 'none';
        }

        function showLoading() {
            loadingElement.style.display = 'block';
        }

        function hideLoading() {
            loadingElement.style.display = 'none';
        }

        function openModal(modalId) {
            const modal = new bootstrap.Modal(document.getElementById(modalId));
            modal.show();
        }

        function closeModal(modalId) {
            const modal = bootstrap.Modal.getInstance(document.getElementById(modalId));
            if (modal) {
                modal.hide();
            }
        }

        function previewNewImage(input) {
            const preview = document.getElementById('newProductImagePreview');
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        function previewEditImage(input) {
            const preview = document.getElementById('editProductImagePreview');
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        function deleteProductConfirm(productId) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŸ')) {
                deleteProduct(productId);
            }
        }

        // ğŸ”¥ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        function initApp() {
            console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚...');
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
            adminLink.addEventListener('click', function(e) {
                e.preventDefault();
                openModal('loginModal');
            });
            
            logoutLink.addEventListener('click', function(e) {
                e.preventDefault();
                adminLogout();
            });
            
            document.getElementById('productType').addEventListener('change', updateDimensionsSelects);
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
            loadProducts();
            loadOrders();
            
            console.log('âœ… ØªÙ… ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ù†Ø¬Ø§Ø­');
        }

        // Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>  
